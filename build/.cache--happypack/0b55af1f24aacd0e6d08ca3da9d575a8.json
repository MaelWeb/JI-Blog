{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[\"react-hmre\"]}!/Users/mael.liang/Workspace/node-koa-test/web/page/admin/BlogBanner/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/page/admin/BlogBanner/index.js","mtime":1515376008745},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _tooltip = require('antd/lib/tooltip');\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _upload = require('antd/lib/upload');\n\nvar _upload2 = _interopRequireDefault(_upload);\n\nvar _button = require('antd/lib/button');\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _icon = require('antd/lib/icon');\n\nvar _icon2 = _interopRequireDefault(_icon);\n\nvar _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');\n\nvar _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _message2 = require('antd/lib/message');\n\nvar _message3 = _interopRequireDefault(_message2);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _input = require('antd/lib/input');\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _layout = require('antd/lib/layout');\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nvar _index = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/redbox-react/lib/index.js');\n\nvar _index2 = _interopRequireDefault(_index);\n\nvar _index3 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-catch-errors/lib/index.js');\n\nvar _index4 = _interopRequireDefault(_index3);\n\nvar _react2 = require('react');\n\nvar _react3 = _interopRequireDefault(_react2);\n\nvar _index5 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-hmr/lib/index.js');\n\nvar _index6 = _interopRequireDefault(_index5);\n\nvar _class, _temp;\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _axios = require('axios');\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _config = require('../../../config/');\n\nrequire('./index.less');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _components = {\n    BannerSetting: {\n        displayName: 'BannerSetting'\n    }\n};\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/page/admin/BlogBanner/index.js',\n    components: _components,\n    locals: [module],\n    imports: [_react3.default]\n});\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/page/admin/BlogBanner/index.js',\n    components: _components,\n    locals: [],\n    imports: [_react3.default, _index2.default]\n});\n\nfunction _wrapComponent(id) {\n    return function (Component) {\n        return _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2(_UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);\n    };\n}\n\nvar Header = _layout2.default.Header,\n    Content = _layout2.default.Content,\n    Footer = _layout2.default.Footer;\nvar TextArea = _input2.default.TextArea;\n\nvar BannerSetting = _wrapComponent('BannerSetting')((_temp = _class = function (_Component) {\n    (0, _inherits3.default)(BannerSetting, _Component);\n\n    function BannerSetting(props) {\n        (0, _classCallCheck3.default)(this, BannerSetting);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (BannerSetting.__proto__ || (0, _getPrototypeOf2.default)(BannerSetting)).call(this, props));\n\n        _this.uploadereChange = function (info) {\n            if (info.file.status === 'done') {\n                _message3.default.success(\"上传成功\");\n                var response = info.file.response;\n\n                _this.setState({\n                    imageUpUrl: '' + _config.IMG_URL + response.data.key,\n                    imageUrl: '' + _config.IMG_URL + response.data.key\n                });\n            }\n        };\n\n        _this.imgInputChange = function (e) {\n            _this.setState({\n                imageUrl: e.target.value\n            });\n        };\n\n        _this.textChange = function (e) {\n            _this.setState({\n                text: e.target.value\n            });\n        };\n\n        _this.hrefChange = function (e) {\n            _this.setState({\n                href: e.target.value\n            });\n        };\n\n        _this.bookNameChange = function (e) {\n            var book = _this.state.book;\n\n            book.author = e.target.value;\n\n            _this.setState({ book: book });\n        };\n\n        _this.bookTextChange = function (e) {\n            var book = _this.state.book;\n\n            book.text = e.target.value.split('||');\n            _this.setState({ book: book });\n        };\n\n        _this.bookHrefChange = function (e) {\n            var book = _this.state.book;\n\n            book.href = e.target.value.split('||');\n            _this.setState({ book: book });\n        };\n\n        _this.addBanner = function (page) {\n            var _this$state = _this.state,\n                imageUrl = _this$state.imageUrl,\n                text = _this$state.text,\n                href = _this$state.href,\n                book = _this$state.book;\n\n            var params = {};\n\n            if (page == 'HOME') {\n                params = { url: imageUrl, text: [text], href: href, page: page };\n            } else {\n                params = (0, _extends3.default)({}, book, { page: page });\n            }\n\n            _axios2.default.post('/api/create/banner', params).then(function (res) {\n                if (res.data.code == 200) {\n                    _message3.default.success(\"添加成功\");\n                    _this.getBanners();\n                } else {\n                    _message3.default.error(\"添加失败\");\n                }\n            });\n        };\n\n        _this.bannerUploaderChange = function (info, index) {\n            if (info.file.status === 'done') {\n                _message3.default.success(\"上传成功\");\n                var response = info.file.response;\n\n                _this.setState(function (preState) {\n                    preState.banners[index].url = '' + _config.IMG_URL + response.data.key;\n\n                    return { banners: preState.banners };\n                });\n            }\n        };\n\n        _this.bannerImgInputChange = function (e, index) {\n            var value = e.target.value;\n            _this.setState(function (preState) {\n                preState.banners[index].url = value;\n\n                return { banners: preState.banners };\n            });\n        };\n\n        _this.bannerTextChange = function (e, index) {\n            var value = e.target.value;\n            _this.setState(function (preState) {\n                preState.banners[index].text = value;\n\n                return { banners: preState.banners };\n            });\n        };\n\n        _this.bannerHrefChange = function (e, index) {\n            var value = e.target.value;\n            _this.setState(function (preState) {\n                preState.banners[index].href = value;\n\n                return { banners: preState.banners };\n            });\n        };\n\n        _this.updateBanner = function (banner) {\n            var id = banner.id,\n                others = (0, _objectWithoutProperties3.default)(banner, ['id']);\n\n            _axios2.default.post('/api/update/banner/' + id, others).then(function (res) {\n                _message3.default.success(res.data.message);\n            });\n        };\n\n        _this.deleteBanner = function (banner) {\n            _axios2.default.delete('/api/banner/' + banner.id).then(function (res) {\n                _message3.default.success(res.data.message);\n                if (res.data.code == 200) {\n                    _this.getBanners();\n                }\n            });\n        };\n\n        _this.state = {\n            imageUrl: '',\n            imageUpUrl: '',\n            text: '',\n            href: '',\n            banners: [],\n            book: {\n                text: [],\n                author: '',\n                href: ''\n            }\n        };\n\n        return _this;\n    }\n\n    (0, _createClass3.default)(BannerSetting, [{\n        key: 'componentWillMount',\n        value: function componentWillMount() {\n            this.getBanners();\n        }\n    }, {\n        key: 'getBanners',\n        value: function getBanners() {\n            var _this2 = this;\n\n            _axios2.default.get(\"/api/get/banners\").then(function (res) {\n                var book = _this2.state.book;\n\n                var banners = [];\n\n                res.data.banners.map(function (banner) {\n                    banner.page == 'HOME' && banners.push(banner);\n                    banner.page == 'BOOK' && (book = banner);\n                });\n                _this2.setState({\n                    banners: banners,\n                    book: book\n                });\n            });\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _this3 = this;\n\n            var _state = this.state,\n                imageUrl = _state.imageUrl,\n                imageUpUrl = _state.imageUpUrl,\n                text = _state.text,\n                href = _state.href,\n                banners = _state.banners,\n                book = _state.book,\n                title = _state.title;\n\n            return _react3.default.createElement(\n                _layout2.default,\n                { className: 'banner-setting-layout' },\n                _react3.default.createElement(\n                    Header,\n                    { className: 'banner-setting-header clearfix' },\n                    _react3.default.createElement(\n                        'h2',\n                        null,\n                        'Banner\\u8BBE\\u7F6E'\n                    )\n                ),\n                _react3.default.createElement(\n                    Content,\n                    { className: 'banner-setting-content' },\n                    _react3.default.createElement(\n                        'h2',\n                        null,\n                        '\\u535A\\u5BA2\\u9996\\u9875'\n                    ),\n                    banners.length ? banners.map(function (banner, index) {\n                        return _react3.default.createElement(\n                            'div',\n                            { className: 'banner-box', key: banner.id },\n                            _react3.default.createElement(\n                                'div',\n                                { className: 'banner-img' },\n                                banner.url ? _react3.default.createElement('img', { src: banner.url, alt: '' }) : _react3.default.createElement(_icon2.default, { type: 'picture' })\n                            ),\n                            _react3.default.createElement(\n                                'div',\n                                { className: 'banner-info' },\n                                _react3.default.createElement(\n                                    'label',\n                                    { htmlFor: '' },\n                                    _react3.default.createElement(\n                                        'span',\n                                        { className: 'laberl-text' },\n                                        '\\u56FE\\u7247\\u5730\\u5740'\n                                    ),\n                                    _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165\\u56FE\\u7247\\u5730\\u5740\\u6216\\u624B\\u52A8\\u4E0A\\u4F20', value: banner.url, onChange: function onChange(e) {\n                                            _this3.bannerImgInputChange(e, index);\n                                        } }),\n                                    _react3.default.createElement(\n                                        _upload2.default,\n                                        {\n                                            className: 'uploader',\n                                            accept: 'image/*',\n                                            action: '/api/fileupload',\n                                            data: { prefix: 'banner/' },\n                                            showUploadList: false,\n                                            onChange: function onChange(info) {\n                                                _this3.bannerUploaderChange(info, index);\n                                            } },\n                                        _react3.default.createElement(\n                                            _button2.default,\n                                            null,\n                                            _react3.default.createElement(_icon2.default, { type: 'upload' }),\n                                            '\\u70B9\\u51FB\\u4E0A\\u4F20'\n                                        )\n                                    )\n                                ),\n                                _react3.default.createElement(\n                                    'label',\n                                    { htmlFor: '' },\n                                    _react3.default.createElement(\n                                        'span',\n                                        { className: 'laberl-text' },\n                                        '\\u63CF\\u8FF0'\n                                    ),\n                                    _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165Banner\\u63CF\\u8FF0', value: banner.text, onChange: function onChange(e) {\n                                            _this3.bannerTextChange(e, index);\n                                        } })\n                                ),\n                                _react3.default.createElement(\n                                    'label',\n                                    { htmlFor: '' },\n                                    _react3.default.createElement(\n                                        'span',\n                                        { className: 'laberl-text' },\n                                        '\\u94FE\\u63A5'\n                                    ),\n                                    _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165Banner\\u76F8\\u5173\\u6587\\u7AE0\\u94FE\\u63A5', value: banner.href, onChange: function onChange(e) {\n                                            _this3.bannerHrefChange(e, index);\n                                        } })\n                                )\n                            ),\n                            _react3.default.createElement(\n                                'div',\n                                { className: 'btn' },\n                                _react3.default.createElement(\n                                    _button2.default,\n                                    { onClick: function onClick() {\n                                            _this3.updateBanner(banner);\n                                        } },\n                                    '\\u4FDD\\u5B58'\n                                ),\n                                _react3.default.createElement(\n                                    _button2.default,\n                                    { onClick: function onClick() {\n                                            _this3.deleteBanner(banner);\n                                        } },\n                                    '\\u5220\\u9664'\n                                )\n                            )\n                        );\n                    }) : null,\n                    banners.length < 3 ? _react3.default.createElement(\n                        'div',\n                        { className: 'banner-box' },\n                        _react3.default.createElement(\n                            'div',\n                            { className: 'banner-img' },\n                            imageUpUrl ? _react3.default.createElement('img', { src: imageUpUrl, alt: '' }) : _react3.default.createElement(_icon2.default, { type: 'picture' })\n                        ),\n                        _react3.default.createElement(\n                            'div',\n                            { className: 'banner-info' },\n                            _react3.default.createElement(\n                                'label',\n                                { htmlFor: '' },\n                                _react3.default.createElement(\n                                    'span',\n                                    { className: 'laberl-text' },\n                                    '\\u56FE\\u7247\\u5730\\u5740'\n                                ),\n                                _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165\\u56FE\\u7247\\u5730\\u5740\\u6216\\u624B\\u52A8\\u4E0A\\u4F20', value: imageUrl, onChange: this.imgInputChange }),\n                                _react3.default.createElement(\n                                    _upload2.default,\n                                    {\n                                        className: 'uploader',\n                                        accept: 'image/*',\n                                        action: '/api/fileupload',\n                                        data: { prefix: 'banner/' },\n                                        showUploadList: false,\n                                        onChange: this.uploadereChange },\n                                    _react3.default.createElement(\n                                        _button2.default,\n                                        null,\n                                        _react3.default.createElement(_icon2.default, { type: 'upload' }),\n                                        '\\u70B9\\u51FB\\u4E0A\\u4F20'\n                                    )\n                                )\n                            ),\n                            _react3.default.createElement(\n                                'label',\n                                { htmlFor: '' },\n                                _react3.default.createElement(\n                                    'span',\n                                    { className: 'laberl-text' },\n                                    '\\u63CF\\u8FF0'\n                                ),\n                                _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165Banner\\u63CF\\u8FF0', value: text, onChange: this.textChange })\n                            ),\n                            _react3.default.createElement(\n                                'label',\n                                { htmlFor: '' },\n                                _react3.default.createElement(\n                                    'span',\n                                    { className: 'laberl-text' },\n                                    '\\u94FE\\u63A5'\n                                ),\n                                _react3.default.createElement(_input2.default, { placeholder: '\\u8BF7\\u8F93\\u5165Banner\\u76F8\\u5173\\u6587\\u7AE0\\u94FE\\u63A5', value: href, onChange: this.hrefChange })\n                            )\n                        ),\n                        _react3.default.createElement(\n                            'div',\n                            { className: 'btn' },\n                            _react3.default.createElement(\n                                _button2.default,\n                                { onClick: function onClick() {\n                                        _this3.addBanner(\"HOME\");\n                                    } },\n                                '\\u6DFB\\u52A0'\n                            )\n                        )\n                    ) : null,\n                    _react3.default.createElement(\n                        'h2',\n                        null,\n                        '\\u56FE\\u4E66\\u9996\\u9875'\n                    ),\n                    _react3.default.createElement(\n                        'div',\n                        { className: 'banner-box book-banner' },\n                        _react3.default.createElement(\n                            _tooltip2.default,\n                            {\n                                trigger: ['focus'],\n                                title: '\\u5EFA\\u8BAE\\u8F93\\u5165150\\u4E2A\\u4EE5\\u5185\\u5B57\\u7B26\\uFF0C\\u5DF2\\u7ECF\\u8F93\\u5165' + book.text.join(\"||\").length + '\\u4E2A',\n                                placement: 'topLeft',\n                                overlayClassName: 'numeric-input'\n                            },\n                            _react3.default.createElement(TextArea, { ref: 'bookText', value: book.text.join(\"||\"), onChange: this.bookTextChange, className: 'book-text', placeholder: '\\u56FE\\u4E66\\u9996\\u9875\\u6587\\u6848\\uFF0C\\u5206\\u4E24\\u90E8\\u5206\\uFF1B\\u4EE5\\'||\\'\\u5206\\u9694', autosize: { minRows: 2, maxRows: 6 } })\n                        ),\n                        _react3.default.createElement(_input2.default, { ref: 'bookHref', value: book.href, onChange: this.bookHrefChange, placeholder: '\\u76F8\\u5173\\u94FE\\u63A5' }),\n                        _react3.default.createElement(_input2.default, { ref: 'bookName', value: book.author, onChange: this.bookNameChange, placeholder: '\\u4E66\\u540D' }),\n                        !book.id ? _react3.default.createElement(\n                            _button2.default,\n                            { onClick: function onClick() {\n                                    _this3.addBanner(\"BOOK\");\n                                } },\n                            '\\u6DFB\\u52A0'\n                        ) : _react3.default.createElement(\n                            _button2.default,\n                            { onClick: function onClick() {\n                                    _this3.updateBanner(book);\n                                } },\n                            '\\u4FDD\\u5B58'\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return BannerSetting;\n}(_react2.Component), _class.contextTypes = {\n    showMessage: _propTypes2.default.func\n}, _temp));\n\nexports.default = BannerSetting;",{"version":3,"sources":["web/page/admin/BlogBanner/index.js"],"names":["Header","Content","Footer","TextArea","props","uploadereChange","info","file","status","success","response","setState","imageUpUrl","data","key","imageUrl","imgInputChange","e","target","value","textChange","text","hrefChange","href","bookNameChange","book","state","author","bookTextChange","split","bookHrefChange","addBanner","params","page","url","post","then","res","code","getBanners","error","bannerUploaderChange","index","preState","banners","bannerImgInputChange","bannerTextChange","bannerHrefChange","updateBanner","banner","id","others","message","deleteBanner","delete","get","map","push","title","length","prefix","join","minRows","maxRows","contextTypes","showMessage","func"],"mappings":"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","file":"index.js","sourceRoot":"/Users/mael.liang/Workspace/node-koa-test","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Layout, Upload, Button, Input, Icon, message, Tooltip } from 'antd';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios';\nimport {IMG_URL, IMG_QUERY} from '../../../config/';\nimport './index.less';\n\nconst {Header, Content, Footer} = Layout;\nconst { TextArea } = Input;\n\nexport default class BannerSetting extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            imageUrl: '',\n            imageUpUrl: '',\n            text: '',\n            href: '',\n            banners: [],\n            book: {\n                text: [],\n                author: '',\n                href: ''\n            }\n        };\n\n    }\n\n    static contextTypes = {\n        showMessage: PropTypes.func\n    };\n\n    componentWillMount() {\n        this.getBanners();\n    }\n\n    getBanners() {\n        Axios.get(\"/api/get/banners\")\n            .then( res => {\n                let { book } = this.state;\n                let banners = [];\n\n                res.data.banners.map( banner => {\n                    (banner.page == 'HOME') && banners.push(banner);\n                    (banner.page == 'BOOK') && (book = banner);\n                });\n                this.setState({\n                    banners,\n                    book\n                })\n            })\n    }\n\n    uploadereChange = (info) => {\n        if (info.file.status === 'done') {\n            message.success(\"上传成功\");\n            const { response } = info.file;\n            this.setState({\n                imageUpUrl: `${IMG_URL}${response.data.key}`,\n                imageUrl: `${IMG_URL}${response.data.key}`\n            });\n        }\n    }\n\n    imgInputChange = e => {\n        this.setState({\n            imageUrl: e.target.value\n        })\n    }\n\n    textChange = e => {\n        this.setState({\n            text: e.target.value\n        })\n    }\n\n    hrefChange = e => {\n        this.setState({\n            href: e.target.value\n        })\n    }\n\n    bookNameChange = e => {\n        let { book } = this.state;\n        book.author = e.target.value;\n\n        this.setState({book});\n    }\n\n    bookTextChange = e => {\n        let { book } = this.state;\n        book.text = e.target.value.split('||');\n        this.setState({book});\n    }\n\n\n    bookHrefChange = e => {\n        let { book } = this.state;\n        book.href = e.target.value.split('||');\n        this.setState({book});\n    }\n\n    addBanner = page => {\n        const { imageUrl, text, href, book } = this.state;\n        let params = {};\n\n        if (page == 'HOME') {\n            params = {url: imageUrl, text: [text], href, page};\n        } else {\n            params = {...book, page};\n        }\n\n        Axios.post('/api/create/banner', params)\n            .then( res => {\n                if (res.data.code == 200) {\n                    message.success(\"添加成功\");\n                    this.getBanners();\n                } else {\n                    message.error(\"添加失败\")\n                }\n            })\n    }\n\n    bannerUploaderChange = (info, index) => {\n        if (info.file.status === 'done') {\n            message.success(\"上传成功\");\n            const { response } = info.file;\n            this.setState(preState => {\n                preState.banners[index].url = `${IMG_URL}${response.data.key}`;\n\n                return { banners: preState.banners}\n            });\n        }\n    }\n\n    bannerImgInputChange = (e, index) => {\n        let value = e.target.value;\n        this.setState(preState => {\n            preState.banners[index].url =value;\n\n            return { banners: preState.banners}\n        })\n    }\n\n    bannerTextChange = (e, index) => {\n        let value = e.target.value;\n        this.setState(preState => {\n            preState.banners[index].text = value;\n\n            return { banners: preState.banners}\n        })\n    }\n\n    bannerHrefChange = (e, index) => {\n        let value = e.target.value;\n        this.setState(preState => {\n            preState.banners[index].href = value;\n\n            return { banners: preState.banners}\n        })\n    }\n\n    updateBanner = (banner) => {\n        const { id, ...others } = banner;\n        Axios.post(`/api/update/banner/${id}`, others)\n            .then( res => {\n                message.success(res.data.message)\n            })\n    }\n\n    deleteBanner = banner => {\n        Axios\n            .delete(`/api/banner/${banner.id}`)\n            .then( res => {\n                message.success(res.data.message)\n                if (res.data.code == 200) {\n                    this.getBanners();\n                }\n            })\n    }\n\n\n    render() {\n        const {imageUrl, imageUpUrl, text, href, banners, book, title} = this.state;\n        return (\n            <Layout className=\"banner-setting-layout\">\n                <Header className='banner-setting-header clearfix' >\n                    <h2>Banner设置</h2>\n                </Header>\n                <Content className=\"banner-setting-content\">\n                <h2>博客首页</h2>\n                 { banners.length ? banners.map( (banner, index) => <div className=\"banner-box\" key={banner.id} >\n                        <div className=\"banner-img\">\n                            { banner.url ? <img src={banner.url} alt=\"\"/> : <Icon type=\"picture\" />}\n                        </div>\n                        <div className=\"banner-info\">\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">图片地址</span>\n                                <Input placeholder=\"请输入图片地址或手动上传\" value={banner.url} onChange={ e => { this.bannerImgInputChange(e, index) } } />\n                                <Upload\n                                    className='uploader'\n                                    accept = \"image/*\"\n                                    action = \"/api/fileupload\"\n                                    data = { { prefix: 'banner/' } }\n                                    showUploadList={ false }\n                                    onChange = { (info) => { this.bannerUploaderChange(info, index) } }>\n                                    <Button>\n                                      <Icon type=\"upload\" />点击上传\n                                    </Button>\n                                </Upload>\n                            </label>\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">描述</span>\n                                <Input placeholder=\"请输入Banner描述\" value={banner.text} onChange={ e => { this.bannerTextChange(e, index) } } />\n                            </label>\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">链接</span>\n                                <Input placeholder=\"请输入Banner相关文章链接\" value={banner.href} onChange={ e => { this.bannerHrefChange(e, index) } }/>\n                            </label>\n                            </div>\n                        <div className=\"btn\">\n                            <Button onClick={ () => { this.updateBanner(banner) } } >保存</Button>\n                            <Button onClick={ () => { this.deleteBanner(banner) } } >删除</Button>\n                        </div>\n                     </div>) : null }\n                    { banners.length < 3 ? <div className=\"banner-box\">\n                        <div className=\"banner-img\">\n                            { imageUpUrl ? <img src={imageUpUrl} alt=\"\"/> : <Icon type=\"picture\" />}\n                        </div>\n                        <div className=\"banner-info\">\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">图片地址</span>\n                                <Input placeholder=\"请输入图片地址或手动上传\" value={imageUrl} onChange={ this.imgInputChange } />\n                                <Upload\n                                    className='uploader'\n                                    accept = \"image/*\"\n                                    action = \"/api/fileupload\"\n                                    data = { { prefix: 'banner/' } }\n                                    showUploadList={ false }\n                                    onChange = { this.uploadereChange } >\n                                    <Button>\n                                      <Icon type=\"upload\" />点击上传\n                                    </Button>\n                                </Upload>\n                            </label>\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">描述</span>\n                                <Input placeholder=\"请输入Banner描述\" value={text} onChange={ this.textChange } />\n                            </label>\n                            <label htmlFor=\"\">\n                                <span className=\"laberl-text\">链接</span>\n                                <Input placeholder=\"请输入Banner相关文章链接\" value={href} onChange={ this.hrefChange } />\n                            </label>\n                        </div>\n                        <div className=\"btn\">\n                            <Button onClick={ () => { this.addBanner(\"HOME\") } } >添加</Button>\n                        </div>\n                    </div> : null}\n                    <h2>图书首页</h2>\n                    <div className=\"banner-box book-banner\">\n                        <Tooltip\n                            trigger={['focus']}\n                            title={`建议输入150个以内字符，已经输入${book.text.join(\"||\").length}个`}\n                            placement=\"topLeft\"\n                            overlayClassName=\"numeric-input\"\n                        >\n                        <TextArea ref=\"bookText\" value={ book.text.join(\"||\") }  onChange={ this.bookTextChange } className=\"book-text\" placeholder=\"图书首页文案，分两部分；以'||'分隔\" autosize={{ minRows: 2, maxRows: 6 }} />\n                        </Tooltip>\n                        <Input ref=\"bookHref\" value={ book.href } onChange={ this.bookHrefChange } placeholder=\"相关链接\" />\n                        <Input ref=\"bookName\" value={ book.author } onChange={ this.bookNameChange } placeholder=\"书名\" />\n                        { !book.id ? <Button onClick={ () => { this.addBanner(\"BOOK\") } } >添加</Button> : <Button onClick={ () => { this.updateBanner(book) } } >保存</Button>}\n                    </div>\n                </Content>\n            </Layout>\n        )\n    }\n}"]}]}