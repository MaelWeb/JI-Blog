{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[]}!/Users/mael.liang/Workspace/node-koa-test/web/page/blog/Travel/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/page/blog/Travel/index.js","mtime":1520474706944},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _reactMasonryComponent = require('react-masonry-component');\n\nvar _reactMasonryComponent2 = _interopRequireDefault(_reactMasonryComponent);\n\nvar _axios = require('axios');\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _moment = require('moment');\n\nvar _moment2 = _interopRequireDefault(_moment);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Travel = function (_Component) {\n    (0, _inherits3.default)(Travel, _Component);\n\n    function Travel(props) {\n        (0, _classCallCheck3.default)(this, Travel);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (Travel.__proto__ || (0, _getPrototypeOf2.default)(Travel)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var travels = props.travels,\n            allNum = props.allNum,\n            page = props.page,\n            allPage = props.allPage;\n\n        _this.state = {\n            travels: travels,\n            allNum: allNum,\n            page: page,\n            allPage: allPage,\n            isLoading: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(Travel, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.headerDom = _reactDom2.default.findDOMNode(this.refs.travelHeader);\n            this.traveLayoutDom = _reactDom2.default.findDOMNode(this);\n            this.blogNavDom = document.getElementById('IdNav');\n\n            this.blogNavDom.classList.add('blog-travel-header');\n\n            window.addEventListener(\"scroll\", this.onscroll, false);\n            var travels = this.state.travels;\n\n\n            if (!travels.length) {\n                this.getArticles(1);\n            }\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            this.blogNavDom.classList.remove('blog-travel-header');\n            window.removeEventListener(\"scroll\", this.onscroll);\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state = this.state,\n                travels = _state.travels,\n                isLoading = _state.isLoading;\n\n            return _react2.default.createElement(\n                'div',\n                { className: 'blog-travel-layout' },\n                _react2.default.createElement(\n                    'div',\n                    { className: 'traverl-header', ref: 'travelHeader', style: { backgroundImage: 'url(' + (travels[0] && travels[0].banner ? travels[0].banner : \"//cdn.liayal.com/12027196.jpg\") + ')' } },\n                    _react2.default.createElement(\n                        _reactRouterDom.Link,\n                        { to: '/article/' + (travels[0] && travels[0].id) },\n                        _react2.default.createElement('img', { src: travels[0] && travels[0].banner ? travels[0].banner : \"//cdn.liayal.com/12027196.jpg\", alt: '', hidden: true }),\n                        travels[0] ? _react2.default.createElement(\n                            'div',\n                            { className: 'aticle-info' },\n                            _react2.default.createElement(\n                                'p',\n                                { className: 'small' },\n                                _react2.default.createElement(\n                                    'span',\n                                    null,\n                                    '\\u6E38\\u8BB0'\n                                )\n                            ),\n                            _react2.default.createElement(\n                                'h2',\n                                null,\n                                travels[0] ? travels[0].title : ''\n                            ),\n                            _react2.default.createElement(\n                                'p',\n                                { className: 'sub-title' },\n                                travels[0] ? travels[0].abstract : ''\n                            )\n                        ) : null\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    { className: 'middle-text tc' },\n                    _react2.default.createElement(\n                        'h2',\n                        null,\n                        '\\u6211\\u4ECE\\u65C5\\u884C\\u4E2D\\u83B7\\u5F97\\u4E50\\u8DA3'\n                    ),\n                    _react2.default.createElement(\n                        'p',\n                        null,\n                        '\\u4E00\\u4E2A\\u4EBA\\uFF0C\\u4E00\\u6761\\u8DEF\\uFF0C\\u4EBA\\u5728\\u9014\\u4E2D\\uFF0C\\u5FC3\\u968F\\u666F\\u52A8\\uFF0C\\u4ECE\\u8D77\\u70B9\\uFF0C\\u5230\\u5C3D\\u5934\\uFF0C\\u4E5F\\u8BB8\\u5FEB\\u4E50\\uFF0C\\u6216\\u6709\\u65F6\\u5B64\\u72EC\\uFF0C\\u5982\\u679C\\u5FC3\\u5728\\u8FDC\\u65B9\\uFF0C\\u53EA\\u9700\\u52C7\\u6562\\u524D\\u884C\\uFF0C\\u68A6\\u60F3\\u81EA\\u4F1A\\u5F15\\u8DEF\\uFF0C\\u6709\\u591A\\u8FDC\\uFF0C\\u8D70\\u591A\\u8FDC\\uFF0C\\u628A\\u8DB3\\u8FF9\\u8FDE\\u6210\\u751F\\u547D\\u7EBF\\u3002'\n                    )\n                ),\n                _react2.default.createElement(\n                    _reactMasonryComponent2.default,\n                    { className: 'travel-article-list' },\n                    travels.length ? travels.map(function (article, index) {\n                        return index != 0 ? _react2.default.createElement(\n                            'div',\n                            { className: 'article-item', key: article.id },\n                            _react2.default.createElement(\n                                _reactRouterDom.Link,\n                                { to: '/article/' + article.id },\n                                _react2.default.createElement('img', { src: article.banner || '//cdn.liayal.com/14506926.jpg', alt: '' }),\n                                _react2.default.createElement(\n                                    'p',\n                                    { className: 'article-title' },\n                                    article.title,\n                                    ' ',\n                                    _react2.default.createElement(\n                                        'small',\n                                        null,\n                                        (0, _moment2.default)(article.createTime).format('MM月DD日')\n                                    )\n                                )\n                            )\n                        ) : null;\n                    }) : null\n                ),\n                isLoading ? _react2.default.createElement(\n                    'p',\n                    { className: 'loading' },\n                    '\\u52A0\\u8F7D\\u4E2D...'\n                ) : null\n            );\n        }\n    }]);\n    return Travel;\n}(_react.Component);\n\nTravel.defaultProps = {\n    travels: [],\n    page: 0,\n    allPage: 0\n};\n\nvar _initialiseProps = function _initialiseProps() {\n    var _this2 = this;\n\n    this.onscroll = function (e) {\n        e = e || window.event;\n        var _scrollTop = window.pageYOffset || document.documentElement && document.documentElement.scrollTop || document.body.scrollTop || 0;;\n        if (_scrollTop >= _this2.headerDom.offsetHeight - _this2.blogNavDom.offsetHeight) {\n            _this2.blogNavDom.classList.remove('blog-travel-header');\n        } else {\n            _this2.blogNavDom.classList.add('blog-travel-header');\n        }\n\n        var _state2 = _this2.state,\n            page = _state2.page,\n            allPage = _state2.allPage;\n\n        if (_scrollTop + document.documentElement.clientHeight > _this2.traveLayoutDom.offsetHeight - 100) {\n            page < allPage && _this2.getArticles(page + 1);\n        }\n    };\n\n    this.getArticles = function (_page) {\n        if (_this2.state.isLoading) return;\n        _this2.setState({\n            isLoading: true\n        });\n        _axios2.default.get('/api/get/publish/articles', {\n            params: {\n                category: 'TRAVEL',\n                page: _page\n            }\n        }).then(function (res) {\n            var resData = res.data;\n            _this2.setState(function (preState) {\n                var articles = preState.travels.concat(resData.articles);\n                return {\n                    travels: articles,\n                    allNum: resData.allNum,\n                    page: resData.page,\n                    allPage: resData.allPage,\n                    isLoading: false\n                };\n            });\n        });\n    };\n};\n\nexports.default = Travel;",null]}