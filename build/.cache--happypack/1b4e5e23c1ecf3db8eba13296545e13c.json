{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[\"react-hmre\"]}!/Users/mael.liang/Workspace/node-koa-test/web/components/CommentInput/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/components/CommentInput/index.js","mtime":1517553126151},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _defineProperty2 = require('babel-runtime/helpers/defineProperty');\n\nvar _defineProperty3 = _interopRequireDefault(_defineProperty2);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _index = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/redbox-react/lib/index.js');\n\nvar _index2 = _interopRequireDefault(_index);\n\nvar _index3 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-catch-errors/lib/index.js');\n\nvar _index4 = _interopRequireDefault(_index3);\n\nvar _react2 = require('react');\n\nvar _react3 = _interopRequireDefault(_react2);\n\nvar _index5 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-hmr/lib/index.js');\n\nvar _index6 = _interopRequireDefault(_index5);\n\nvar _class, _temp;\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _Icon = require('../Icon');\n\nvar _Icon2 = _interopRequireDefault(_Icon);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _data = require('./data');\n\nvar _data2 = _interopRequireDefault(_data);\n\nvar _Emoji = require('../Emoji');\n\nvar _Emoji2 = _interopRequireDefault(_Emoji);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _components = {\n    CommentInput: {\n        displayName: 'CommentInput'\n    }\n};\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/components/CommentInput/index.js',\n    components: _components,\n    locals: [module],\n    imports: [_react3.default]\n});\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/components/CommentInput/index.js',\n    components: _components,\n    locals: [],\n    imports: [_react3.default, _index2.default]\n});\n\nfunction _wrapComponent(id) {\n    return function (Component) {\n        return _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2(_UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);\n    };\n}\n\nvar CommentInput = _wrapComponent('CommentInput')((_temp = _class = function (_Component) {\n    (0, _inherits3.default)(CommentInput, _Component);\n\n    function CommentInput(props) {\n        (0, _classCallCheck3.default)(this, CommentInput);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (CommentInput.__proto__ || (0, _getPrototypeOf2.default)(CommentInput)).call(this, props));\n\n        _this.addEmoji = function (event) {\n            _this.caretIndex = _this.getCaretPosition();\n            _this.setCaretPosition(_this.caretIndex);\n            _this.insertText(event.target.title);\n        };\n\n        _this.toggleEmoji = function () {\n            _this.caretIndex = _this.getCaretPosition();\n            _this.setState(function (preState) {\n                return { showEmoji: !preState.showEmoji };\n            }, function () {\n                _this.setCaretPosition(_this.caretIndex);\n            });\n        };\n\n        _this.exportComment = function () {\n            var commentCont = _this.refs.commentText.value;\n            _this.props.exportComment(commentCont);\n        };\n\n        _this.clearTextarea = function () {\n            _this.textareaDom.value = '';\n        };\n\n        _this.state = {\n            showEmoji: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(CommentInput, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            // this.textareaDom = document.getElementById(this.textareaId);\n            this.textareaDom = _reactDom2.default.findDOMNode(this.refs.commentText);\n        }\n    }, {\n        key: 'getCaretPosition',\n\n\n        //获取光标位置\n        value: function getCaretPosition() {\n            var CaretPos = 0;\n            if (document.selection) {\n                // IE Support\n                this.textareaDom.focus();\n                var Sel = document.selection.createRange();\n                Sel.moveStart('character', -this.textareaDom.value.length);\n                CaretPos = Sel.text.length;\n            } else if (this.textareaDom.selectionStart || this.textareaDom.selectionStart == '0') {\n                // Firefox support\n                CaretPos = this.textareaDom.selectionStart;\n            }\n\n            return CaretPos;\n        }\n\n        //设置光标位置函数\n\n    }, {\n        key: 'setCaretPosition',\n        value: function setCaretPosition(pos) {\n            if (this.textareaDom.setSelectionRange) {\n                this.textareaDom.focus();\n                this.textareaDom.setSelectionRange(pos, pos);\n            } else if (this.textareaDom.createTextRange) {\n                var range = this.textareaDom.createTextRange();\n                range.collapse(true);\n                range.moveEnd('character', pos);\n                range.moveStart('character', pos);\n                range.select();\n            }\n        }\n    }, {\n        key: 'insertText',\n        value: function insertText(str) {\n            if (document.selection) {\n                this.textareaDom.focus();\n                var sel = document.selection.createRange();\n                sel.text = str;\n            } else if (typeof this.textareaDom.selectionStart === 'number' && typeof this.textareaDom.selectionEnd === 'number') {\n                var startPos = this.textareaDom.selectionStart,\n                    endPos = this.textareaDom.selectionEnd,\n                    cursorPos = startPos,\n                    tmpStr = this.textareaDom.value;\n                this.textareaDom.value = tmpStr.substring(0, startPos) + str + tmpStr.substring(endPos, tmpStr.length);\n                cursorPos += str.length;\n                this.textareaDom.selectionStart = this.textareaDom.selectionEnd = cursorPos;\n            } else {\n                this.textareaDom.value += str;\n            }\n            this.caretIndex = this.getCaretPosition();\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var showEmoji = this.state.showEmoji;\n            var _props = this.props,\n                isShowBtn = _props.isShowBtn,\n                className = _props.className;\n\n            return _react3.default.createElement(\n                'div',\n                { className: (0, _classnames2.default)(\"blog-comment-input\", (0, _defineProperty3.default)({}, className, className)) },\n                _react3.default.createElement('textarea', { rows: '4', ref: 'commentText', placeholder: '\\u4F60\\u4E0D\\u60F3\\u8BF4\\u70B9\\u5565\\u4E48\\uFF1F' }),\n                _react3.default.createElement(\n                    'div',\n                    { className: 'btn clearfix' },\n                    _react3.default.createElement(_Icon2.default, { type: 'emoji', className: 'fl', onClick: this.toggleEmoji }),\n                    isShowBtn ? _react3.default.createElement(\n                        'button',\n                        { onClick: this.exportComment },\n                        '\\u53D1\\u5E03'\n                    ) : null\n                ),\n                _react3.default.createElement(\n                    'div',\n                    { className: (0, _classnames2.default)(\"emoji-box\", { show: showEmoji }), id: 'CommentEmoji' },\n                    _react3.default.createElement(\n                        _Emoji2.default,\n                        { style: { height: 20, cursor: 'pointer' }, onClick: this.addEmoji },\n                        _react3.default.createElement(\n                            'div',\n                            { className: 'emoji-wrap' },\n                            _data2.default\n                        )\n                    )\n                )\n            );\n        }\n    }]);\n    return CommentInput;\n}(_react2.Component), _class.defaultProps = {\n    exportComment: function exportComment() {},\n    isShowBtn: true\n}, _class.defaultPropTypes = {\n    exportComment: _propTypes2.default.func,\n    isShowBtn: _propTypes2.default.boolen\n}, _temp));\n\nexports.default = CommentInput;",{"version":3,"sources":["web/components/CommentInput/index.js"],"names":["props","addEmoji","event","caretIndex","getCaretPosition","setCaretPosition","insertText","target","title","toggleEmoji","setState","showEmoji","preState","exportComment","commentCont","refs","commentText","value","clearTextarea","textareaDom","state","findDOMNode","CaretPos","document","selection","focus","Sel","createRange","moveStart","length","text","selectionStart","pos","setSelectionRange","createTextRange","range","collapse","moveEnd","select","str","sel","selectionEnd","startPos","endPos","cursorPos","tmpStr","substring","isShowBtn","className","show","height","cursor","defaultProps","defaultPropTypes","func","boolen"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGI,0BAAYA,KAAZ,EAAmB;AAAA;;AAAA,sJACTA,KADS;;AAAA,cAuBnBC,QAvBmB,GAuBR,UAACC,KAAD,EAAW;AAClB,kBAAKC,UAAL,GAAkB,MAAKC,gBAAL,EAAlB;AACA,kBAAKC,gBAAL,CAAsB,MAAKF,UAA3B;AACA,kBAAKG,UAAL,CAAgBJ,MAAMK,MAAN,CAAaC,KAA7B;AACH,SA3BkB;;AAAA,cA6BnBC,WA7BmB,GA6BL,YAAM;AAChB,kBAAKN,UAAL,GAAkB,MAAKC,gBAAL,EAAlB;AACA,kBAAKM,QAAL,CAAc,oBAAY;AACtB,uBAAO,EAAEC,WAAW,CAACC,SAASD,SAAvB,EAAP;AACH,aAFD,EAEG,YAAM;AACL,sBAAKN,gBAAL,CAAsB,MAAKF,UAA3B;AACH,aAJD;AAKH,SApCkB;;AAAA,cAwFnBU,aAxFmB,GAwFH,YAAM;AAClB,gBAAMC,cAAc,MAAKC,IAAL,CAAUC,WAAV,CAAsBC,KAA1C;AACA,kBAAKjB,KAAL,CAAWa,aAAX,CAAyBC,WAAzB;AACH,SA3FkB;;AAAA,cA6FnBI,aA7FmB,GA6FH,YAAM;AAClB,kBAAKC,WAAL,CAAiBF,KAAjB,GAAyB,EAAzB;AACH,SA/FkB;;AAGf,cAAKG,KAAL,GAAa;AACTT,uBAAW;AADF,SAAb;AAHe;AAMlB;;;;4CAYmB;AAChB;AACA,iBAAKQ,WAAL,GAAmB,mBAASE,WAAT,CAAqB,KAAKN,IAAL,CAAUC,WAA/B,CAAnB;AACH;;;;;AAiBD;2CACoB;AAChB,gBAAIM,WAAW,CAAf;AACA,gBAAIC,SAASC,SAAb,EAAwB;AACpB;AACA,qBAAKL,WAAL,CAAiBM,KAAjB;AACA,oBAAIC,MAAMH,SAASC,SAAT,CAAmBG,WAAnB,EAAV;AACAD,oBAAIE,SAAJ,CAAe,WAAf,EAA4B,CAAC,KAAKT,WAAL,CAAiBF,KAAjB,CAAuBY,MAApD;AACAP,2BAAWI,IAAII,IAAJ,CAASD,MAApB;AACH,aAND,MAMO,IAAI,KAAKV,WAAL,CAAiBY,cAAjB,IAAmC,KAAKZ,WAAL,CAAiBY,cAAjB,IAAmC,GAA1E,EAA+E;AAClF;AACAT,2BAAW,KAAKH,WAAL,CAAiBY,cAA5B;AACH;;AAED,mBAAOT,QAAP;AACH;;AAED;;;;yCACiBU,G,EAAI;AACjB,gBAAG,KAAKb,WAAL,CAAiBc,iBAApB,EAAuC;AACnC,qBAAKd,WAAL,CAAiBM,KAAjB;AACA,qBAAKN,WAAL,CAAiBc,iBAAjB,CAAmCD,GAAnC,EAAuCA,GAAvC;AACH,aAHD,MAGO,IAAI,KAAKb,WAAL,CAAiBe,eAArB,EAAsC;AACzC,oBAAIC,QAAQ,KAAKhB,WAAL,CAAiBe,eAAjB,EAAZ;AACAC,sBAAMC,QAAN,CAAe,IAAf;AACAD,sBAAME,OAAN,CAAc,WAAd,EAA2BL,GAA3B;AACAG,sBAAMP,SAAN,CAAgB,WAAhB,EAA6BI,GAA7B;AACAG,sBAAMG,MAAN;AACH;AACJ;;;mCAEUC,G,EAAK;AACZ,gBAAIhB,SAASC,SAAb,EAAwB;AACpB,qBAAKL,WAAL,CAAiBM,KAAjB;AACA,oBAAIe,MAAMjB,SAASC,SAAT,CAAmBG,WAAnB,EAAV;AACAa,oBAAIV,IAAJ,GAAWS,GAAX;AACH,aAJD,MAIO,IAAI,OAAO,KAAKpB,WAAL,CAAiBY,cAAxB,KAA2C,QAA3C,IAAuD,OAAO,KAAKZ,WAAL,CAAiBsB,YAAxB,KAAyC,QAApG,EAA8G;AACjH,oBAAIC,WAAW,KAAKvB,WAAL,CAAiBY,cAAhC;AAAA,oBACIY,SAAS,KAAKxB,WAAL,CAAiBsB,YAD9B;AAAA,oBAEIG,YAAYF,QAFhB;AAAA,oBAGIG,SAAS,KAAK1B,WAAL,CAAiBF,KAH9B;AAIA,qBAAKE,WAAL,CAAiBF,KAAjB,GAAyB4B,OAAOC,SAAP,CAAiB,CAAjB,EAAoBJ,QAApB,IAAgCH,GAAhC,GAAsCM,OAAOC,SAAP,CAAiBH,MAAjB,EAAyBE,OAAOhB,MAAhC,CAA/D;AACAe,6BAAaL,IAAIV,MAAjB;AACA,qBAAKV,WAAL,CAAiBY,cAAjB,GAAkC,KAAKZ,WAAL,CAAiBsB,YAAjB,GAAgCG,SAAlE;AACH,aARM,MAQA;AACH,qBAAKzB,WAAL,CAAiBF,KAAjB,IAA0BsB,GAA1B;AACH;AACD,iBAAKpC,UAAL,GAAkB,KAAKC,gBAAL,EAAlB;AACH;;;iCAYQ;AAAA,gBACGO,SADH,GACiB,KAAKS,KADtB,CACGT,SADH;AAAA,yBAE4B,KAAKX,KAFjC;AAAA,gBAEG+C,SAFH,UAEGA,SAFH;AAAA,gBAEcC,SAFd,UAEcA,SAFd;;AAGL,mBACI;AAAA;AAAA,kBAAK,WAAY,0BAAW,oBAAX,oCAAmCA,SAAnC,EAA+CA,SAA/C,EAAjB;AACI,4DAAU,MAAK,GAAf,EAAmB,KAAI,aAAvB,EAAqC,aAAY,kDAAjD,GADJ;AAEI;AAAA;AAAA,sBAAK,WAAU,cAAf;AACI,oEAAM,MAAK,OAAX,EAAmB,WAAU,IAA7B,EAAkC,SAAU,KAAKvC,WAAjD,GADJ;AAEMsC,gCAAY;AAAA;AAAA,0BAAQ,SAAU,KAAKlC,aAAvB;AAAA;AAAA,qBAAZ,GAAkE;AAFxE,iBAFJ;AAMI;AAAA;AAAA,sBAAK,WAAY,0BAAW,WAAX,EAAwB,EAAEoC,MAAMtC,SAAR,EAAxB,CAAjB,EAA+D,IAAG,cAAlE;AACI;AAAA;AAAA,0BAAS,OAAO,EAACuC,QAAQ,EAAT,EAAaC,QAAQ,SAArB,EAAhB,EAAiD,SAAU,KAAKlD,QAAhE;AACI;AAAA;AAAA,8BAAK,WAAU,YAAf;AAAA;AAAA;AADJ;AADJ;AANJ,aADJ;AAgBH;;;6BA7GMmD,Y,GAAe;AAClBvC,mBAAe,yBAAM,CAAE,CADL;AAElBkC,eAAW;AAFO,C,SAKfM,gB,GAAmB;AACtBxC,mBAAe,oBAAUyC,IADH;AAEtBP,eAAW,oBAAUQ;AAFC,C","file":"index.js","sourceRoot":"/Users/mael.liang/Workspace/node-koa-test","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport PropTypes from 'prop-types';\nimport Icon from '../Icon';\nimport ClassNames from 'classnames';\nimport EmojiData from './data';\nimport Emojify from '../Emoji';\n\nexport default class CommentInput extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showEmoji: false,\n        };\n    }\n\n    static defaultProps = {\n        exportComment: () => {},\n        isShowBtn: true\n    };\n\n    static defaultPropTypes = {\n        exportComment: PropTypes.func,\n        isShowBtn: PropTypes.boolen\n    };\n\n    componentDidMount() {\n        // this.textareaDom = document.getElementById(this.textareaId);\n        this.textareaDom = ReactDOM.findDOMNode(this.refs.commentText);\n    }\n\n    addEmoji = (event) => {\n        this.caretIndex = this.getCaretPosition();\n        this.setCaretPosition(this.caretIndex);\n        this.insertText(event.target.title);\n    }\n\n    toggleEmoji = () => {\n        this.caretIndex = this.getCaretPosition();\n        this.setState(preState => {\n            return { showEmoji: !preState.showEmoji }\n        }, () => {\n            this.setCaretPosition(this.caretIndex);\n        })\n    }\n\n    //获取光标位置\n    getCaretPosition () {\n        let CaretPos = 0;\n        if (document.selection) {\n            // IE Support\n            this.textareaDom.focus ();\n            let Sel = document.selection.createRange ();\n            Sel.moveStart ('character', -this.textareaDom.value.length);\n            CaretPos = Sel.text.length;\n        } else if (this.textareaDom.selectionStart || this.textareaDom.selectionStart == '0') {\n            // Firefox support\n            CaretPos = this.textareaDom.selectionStart;\n        }\n\n        return CaretPos;\n    }\n\n    //设置光标位置函数\n    setCaretPosition(pos){\n        if(this.textareaDom.setSelectionRange) {\n            this.textareaDom.focus();\n            this.textareaDom.setSelectionRange(pos,pos);\n        } else if (this.textareaDom.createTextRange) {\n            var range = this.textareaDom.createTextRange();\n            range.collapse(true);\n            range.moveEnd('character', pos);\n            range.moveStart('character', pos);\n            range.select();\n        }\n    }\n\n    insertText(str) {\n        if (document.selection) {\n            this.textareaDom.focus();\n            var sel = document.selection.createRange();\n            sel.text = str;\n        } else if (typeof this.textareaDom.selectionStart === 'number' && typeof this.textareaDom.selectionEnd === 'number') {\n            var startPos = this.textareaDom.selectionStart,\n                endPos = this.textareaDom.selectionEnd,\n                cursorPos = startPos,\n                tmpStr = this.textareaDom.value;\n            this.textareaDom.value = tmpStr.substring(0, startPos) + str + tmpStr.substring(endPos, tmpStr.length);\n            cursorPos += str.length;\n            this.textareaDom.selectionStart = this.textareaDom.selectionEnd = cursorPos;\n        } else {\n            this.textareaDom.value += str;\n        }\n        this.caretIndex = this.getCaretPosition();\n    }\n\n    exportComment = () => {\n        const commentCont = this.refs.commentText.value;\n        this.props.exportComment(commentCont);\n    }\n\n    clearTextarea = () => {\n        this.textareaDom.value = '';\n    }\n\n\n    render() {\n        const { showEmoji } = this.state;\n        const { isShowBtn, className } = this.props;\n        return (\n            <div className={ ClassNames(\"blog-comment-input\", {[className]: className}) }>\n                <textarea rows=\"4\" ref=\"commentText\" placeholder='你不想说点啥么？' ></textarea>\n                <div className=\"btn clearfix\">\n                    <Icon type='emoji' className='fl' onClick={ this.toggleEmoji } />\n                    { isShowBtn ? <button onClick={ this.exportComment } >发布</button> : null}\n                </div>\n                <div className={ ClassNames(\"emoji-box\", { show: showEmoji}) } id='CommentEmoji' >\n                    <Emojify style={{height: 20, cursor: 'pointer'}} onClick={ this.addEmoji }>\n                        <div className='emoji-wrap'>\n                            {EmojiData}\n                        </div>\n                    </Emojify>\n                </div>\n            </div>\n        )\n    }\n}"]}]}