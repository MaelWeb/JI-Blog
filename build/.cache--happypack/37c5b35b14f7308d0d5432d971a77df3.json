{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[\"react-hmre\"]}!/Users/mael.liang/Workspace/node-koa-test/web/page/admin/CommentsManage/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/page/admin/CommentsManage/index.js","mtime":1517558604560},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _pagination = require('antd/lib/pagination');\n\nvar _pagination2 = _interopRequireDefault(_pagination);\n\nvar _col = require('antd/lib/col');\n\nvar _col2 = _interopRequireDefault(_col);\n\nvar _card = require('antd/lib/card');\n\nvar _card2 = _interopRequireDefault(_card);\n\nvar _tooltip = require('antd/lib/tooltip');\n\nvar _tooltip2 = _interopRequireDefault(_tooltip);\n\nvar _icon = require('antd/lib/icon');\n\nvar _icon2 = _interopRequireDefault(_icon);\n\nvar _extends2 = require('babel-runtime/helpers/extends');\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _modal = require('antd/lib/modal');\n\nvar _modal2 = _interopRequireDefault(_modal);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _button = require('antd/lib/button');\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _layout = require('antd/lib/layout');\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nvar _index = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/redbox-react/lib/index.js');\n\nvar _index2 = _interopRequireDefault(_index);\n\nvar _index3 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-catch-errors/lib/index.js');\n\nvar _index4 = _interopRequireDefault(_index3);\n\nvar _react2 = require('react');\n\nvar _react3 = _interopRequireDefault(_react2);\n\nvar _index5 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-hmr/lib/index.js');\n\nvar _index6 = _interopRequireDefault(_index5);\n\nvar _class, _temp;\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _axios = require('axios');\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _reactMasonryComponent = require('react-masonry-component');\n\nvar _reactMasonryComponent2 = _interopRequireDefault(_reactMasonryComponent);\n\nvar _Emoji = require('Components/Emoji');\n\nvar _Emoji2 = _interopRequireDefault(_Emoji);\n\nvar _CommentInput = require('Components/CommentInput');\n\nvar _CommentInput2 = _interopRequireDefault(_CommentInput);\n\nrequire('Components/CommentInput/index.less');\n\nrequire('./index.less');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _components = {\n    ComponentsManege: {\n        displayName: 'ComponentsManege'\n    }\n};\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/page/admin/CommentsManage/index.js',\n    components: _components,\n    locals: [module],\n    imports: [_react3.default]\n});\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/page/admin/CommentsManage/index.js',\n    components: _components,\n    locals: [],\n    imports: [_react3.default, _index2.default]\n});\n\nfunction _wrapComponent(id) {\n    return function (Component) {\n        return _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2(_UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);\n    };\n}\n\nvar Header = _layout2.default.Header,\n    Content = _layout2.default.Content,\n    Footer = _layout2.default.Footer;\n\nvar ButtonGroup = _button2.default.Group;\nvar emojiStyle = {\n    height: 20\n};\n\nvar ComponentsManege = _wrapComponent('ComponentsManege')((_temp = _class = function (_Component) {\n    (0, _inherits3.default)(ComponentsManege, _Component);\n\n    function ComponentsManege(props) {\n        (0, _classCallCheck3.default)(this, ComponentsManege);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (ComponentsManege.__proto__ || (0, _getPrototypeOf2.default)(ComponentsManege)).call(this, props));\n\n        _this.changePage = function (page) {\n            _this.getComments(page);\n        };\n\n        _this.toggleComment = function (comment, index) {\n            _axios2.default.post('/api/toggle/comment', {\n                id: comment.id,\n                isRemove: !comment.isRemove\n            });\n\n            _this.setState(function (preState) {\n                var comments = preState.comments;\n                comments[index].isRemove = !comment.isRemove;\n                return {\n                    comments: comments\n                };\n            });\n        };\n\n        _this.deleteComment = function (comment) {\n            _modal2.default.confirm({\n                title: '确定删除当前评论?',\n                content: '评论删除后不可恢复',\n                okText: '删除',\n                okType: 'danger',\n                cancelText: '取消',\n                onOk: function onOk() {\n                    return _this.doDelete(comment.id);\n                }\n            });\n        };\n\n        _this.repeatComment = function (comment) {\n            _this.setState({\n                isRepeatModalShow: true,\n                respondent: comment\n            });\n        };\n\n        _this.hideRepeat = function () {\n            _this.setState({\n                isRepeatModalShow: false\n            });\n        };\n\n        _this.repeat = function () {\n            var respondent = _this.state.respondent;\n\n            var commentCont = _this.refs.replyInput.textareaDom.value;\n            if (!commentCont) return _this.context.showMessage('请输入回复内容');\n            var data = {\n                articleid: respondent.articleid,\n                commentCont: _this.refs.replyInput.textareaDom.value,\n                reply: respondent.id,\n                user: {\n                    name: '记小栈',\n                    email: 'mael.liang@live.com',\n                    site: 'https://www.liayal.com',\n                    avatar: 'https://cdn.liayal.com/image/logo_min.png'\n                }\n            };\n            _axios2.default.post('/api/create/comment', (0, _extends3.default)({}, data)).then(function (res) {\n                var resdata = res.data;\n                if (resdata.code == 200) {\n                    _this.getComments();\n                    _this.hideRepeat();\n                } else {\n                    _this.context.showMessage(resdata.message);\n                }\n            }).catch(function (err) {\n                _this.context.showMessage('发布失败');\n            });\n        };\n\n        _this.state = {\n            pageSize: 12,\n            comments: [],\n            page: 1,\n            isRepeatModalShow: false,\n            respondent: {}\n        };\n\n        _this.hasLoad = false;\n        return _this;\n    }\n\n    (0, _createClass3.default)(ComponentsManege, [{\n        key: 'componentWillMount',\n        value: function componentWillMount() {\n            this.getComments(1);\n        }\n    }, {\n        key: 'getComments',\n        value: function getComments(_page) {\n            var _this2 = this;\n\n            var _state = this.state,\n                pageSize = _state.pageSize,\n                page = _state.page;\n\n            _axios2.default.get('/api/get/comments', {\n                params: {\n                    page: _page || page,\n                    size: pageSize\n                }\n            }).then(function (res) {\n                _this2.hasLoad = true;\n                _this2.setState({\n                    comments: res.data.comments || [],\n                    allNum: res.data.allNum,\n                    page: res.data.page\n                });\n            });\n        }\n    }, {\n        key: 'doDelete',\n        value: function doDelete(id) {\n            var _this3 = this;\n\n            return _axios2.default.delete('/api/comment/' + id).then(function (res) {\n                if (res.data.code) {\n                    _this3.context.showMessage(res.data.message);\n                    _this3.getComments();\n                }\n            }).catch(function (err) {\n                _this3.context.showMessage(err);\n            });\n        }\n    }, {\n        key: 'showComments',\n        value: function showComments() {\n            var _this4 = this;\n\n            var comments = this.state.comments;\n\n            var bodyStyle = { padding: '15px' };\n\n            return comments.length ? comments.map(function (comment, index) {\n                return _react3.default.createElement(\n                    _col2.default,\n                    { span: 8, key: comment.id },\n                    _react3.default.createElement(\n                        _card2.default,\n                        { title: _react3.default.createElement(\n                                'span',\n                                null,\n                                _react3.default.createElement(_icon2.default, { type: 'user' }),\n                                ' ',\n                                comment.user.name\n                            ), extra: _react3.default.createElement(_icon2.default, { type: 'delete', className: 'comment-delete', onClick: function onClick(e) {\n                                    return _this4.deleteComment(comment);\n                                } }), bodyStyle: bodyStyle },\n                        _react3.default.createElement(\n                            _tooltip2.default,\n                            { placement: 'topLeft', title: '\\u70B9\\u51FB\\u5185\\u5BB9\\u53BB\\u5BF9\\u5E94\\u6587\\u7AE0' },\n                            _react3.default.createElement(\n                                'div',\n                                { className: 'comment-content' },\n                                _react3.default.createElement(\n                                    'a',\n                                    { href: comment.articleid ? window.location.origin + '/article/' + comment.articleid : 'javascript:void(0);', className: '' },\n                                    _react3.default.createElement(\n                                        _Emoji2.default,\n                                        { style: emojiStyle },\n                                        comment.commentCont\n                                    )\n                                )\n                            )\n                        ),\n                        _react3.default.createElement(\n                            'div',\n                            { className: 'comment-footer clearfix' },\n                            _react3.default.createElement(_icon2.default, { type: 'mail' }),\n                            _react3.default.createElement(\n                                'span',\n                                null,\n                                comment.user.email\n                            ),\n                            _react3.default.createElement(\n                                ButtonGroup,\n                                { className: 'fr' },\n                                _react3.default.createElement(\n                                    _button2.default,\n                                    { ghost: true, type: 'primary', size: 'small', onClick: function onClick(e) {\n                                            _this4.repeatComment(comment);\n                                        } },\n                                    _react3.default.createElement(_icon2.default, { type: 'message' }),\n                                    '\\u56DE\\u590D'\n                                ),\n                                _react3.default.createElement(\n                                    _button2.default,\n                                    { ghost: true, type: 'primary', size: 'small', onClick: function onClick(e) {\n                                            _this4.toggleComment(comment, index);\n                                        } },\n                                    comment.isRemove ? _react3.default.createElement(\n                                        'span',\n                                        null,\n                                        _react3.default.createElement(_icon2.default, { type: 'eye' }),\n                                        '\\u663E\\u793A'\n                                    ) : _react3.default.createElement(\n                                        'span',\n                                        null,\n                                        _react3.default.createElement(_icon2.default, { type: 'eye-o' }),\n                                        '\\u9690\\u85CF'\n                                    )\n                                )\n                            )\n                        )\n                    )\n                );\n            }) : null;\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state2 = this.state,\n                comments = _state2.comments,\n                page = _state2.page,\n                allNum = _state2.allNum,\n                pageSize = _state2.pageSize,\n                isRepeatModalShow = _state2.isRepeatModalShow,\n                respondent = _state2.respondent;\n\n            return _react3.default.createElement(\n                _layout2.default,\n                { className: 'comments-manage-layout' },\n                _react3.default.createElement(\n                    Header,\n                    { className: 'comments-manage-header clearfix' },\n                    _react3.default.createElement(\n                        'h2',\n                        null,\n                        '\\u8BC4\\u8BBA\\u7BA1\\u7406'\n                    )\n                ),\n                _react3.default.createElement(\n                    Content,\n                    { className: 'comments-manage-content' },\n                    comments.length ? _react3.default.createElement(\n                        _reactMasonryComponent2.default,\n                        { className: 'comments-list' },\n                        this.showComments()\n                    ) : _react3.default.createElement(\n                        'p',\n                        { className: 'tc', style: { fontSize: '.2rem', padding: '.4rem 0' } },\n                        '~~ \\u6682\\u65E0\\u8BC4\\u8BBA ~~'\n                    )\n                ),\n                comments.length ? _react3.default.createElement(\n                    Footer,\n                    null,\n                    _react3.default.createElement(_pagination2.default, { className: 'tc', showQuickJumper: true, current: page, total: allNum, onChange: this.changePage, pageSize: pageSize })\n                ) : null,\n                _react3.default.createElement(\n                    _modal2.default,\n                    {\n                        title: '\\u56DE\\u590D\\uFF1A' + (respondent.user && respondent.user.name),\n                        visible: isRepeatModalShow,\n                        onOk: this.repeat,\n                        onCancel: this.hideRepeat,\n                        okText: '\\u786E\\u5B9A',\n                        cancelText: '\\u53D6\\u6D88',\n                        mask: false },\n                    _react3.default.createElement(_CommentInput2.default, { isShowBtn: false, ref: 'replyInput' })\n                )\n            );\n        }\n    }]);\n    return ComponentsManege;\n}(_react2.Component), _class.contextTypes = {\n    showMessage: _propTypes2.default.func\n}, _temp));\n\nexports.default = ComponentsManege;",{"version":3,"sources":["web/page/admin/CommentsManage/index.js"],"names":["Header","Content","Footer","ButtonGroup","Group","emojiStyle","height","props","changePage","getComments","page","toggleComment","comment","index","post","id","isRemove","setState","comments","preState","deleteComment","confirm","title","content","okText","okType","cancelText","onOk","doDelete","repeatComment","isRepeatModalShow","respondent","hideRepeat","repeat","state","commentCont","refs","replyInput","textareaDom","value","context","showMessage","data","articleid","reply","user","name","email","site","avatar","then","resdata","res","code","message","catch","pageSize","hasLoad","_page","get","params","size","allNum","delete","err","bodyStyle","padding","length","map","window","location","origin","showComments","fontSize","contextTypes","func"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAEQA,M,oBAAAA,M;IAAQC,O,oBAAAA,O;IAASC,M,oBAAAA,M;;AACzB,IAAMC,cAAc,iBAAOC,KAA3B;AACA,IAAMC,aAAa;AACfC,YAAQ;AADO,CAAnB;;;;;AAKI,8BAAYC,KAAZ,EAAmB;AAAA;;AAAA,8JACTA,KADS;;AAAA,cAwCnBC,UAxCmB,GAwCN,gBAAQ;AACjB,kBAAKC,WAAL,CAAiBC,IAAjB;AACH,SA1CkB;;AAAA,cA4CnBC,aA5CmB,GA4CH,UAACC,OAAD,EAAUC,KAAV,EAAoB;AAChC,4BAAMC,IAAN,CAAW,qBAAX,EAAkC;AAC9BC,oBAAIH,QAAQG,EADkB;AAE9BC,0BAAU,CAACJ,QAAQI;AAFW,aAAlC;;AAKA,kBAAKC,QAAL,CAAe,oBAAY;AACvB,oBAAIC,WAAWC,SAASD,QAAxB;AACAA,yBAASL,KAAT,EAAgBG,QAAhB,GAA2B,CAACJ,QAAQI,QAApC;AACA,uBAAO;AACHE;AADG,iBAAP;AAGH,aAND;AAOH,SAzDkB;;AAAA,cAyEnBE,aAzEmB,GAyEH,mBAAW;AACvB,4BAAMC,OAAN,CAAc;AACVC,uBAAO,WADG;AAEVC,yBAAS,WAFC;AAGVC,wBAAQ,IAHE;AAIVC,wBAAQ,QAJE;AAKVC,4BAAY,IALF;AAMVC,sBAAM,gBAAM;AACR,2BAAO,MAAKC,QAAL,CAAchB,QAAQG,EAAtB,CAAP;AACH;AARS,aAAd;AAUH,SApFkB;;AAAA,cAsFnBc,aAtFmB,GAsFH,mBAAW;AACvB,kBAAKZ,QAAL,CAAc;AACVa,mCAAmB,IADT;AAEVC,4BAAYnB;AAFF,aAAd;AAIH,SA3FkB;;AAAA,cA6FnBoB,UA7FmB,GA6FN,YAAM;AACf,kBAAKf,QAAL,CAAc;AACVa,mCAAmB;AADT,aAAd;AAGH,SAjGkB;;AAAA,cAmGnBG,MAnGmB,GAmGV,YAAM;AAAA,gBACHF,UADG,GACY,MAAKG,KADjB,CACHH,UADG;;AAEX,gBAAII,cAAc,MAAKC,IAAL,CAAUC,UAAV,CAAqBC,WAArB,CAAiCC,KAAnD;AACA,gBAAI,CAACJ,WAAL,EAAkB,OAAO,MAAKK,OAAL,CAAaC,WAAb,CAAyB,SAAzB,CAAP;AAClB,gBAAIC,OAAO;AACPC,2BAAWZ,WAAWY,SADf;AAEPR,6BAAa,MAAKC,IAAL,CAAUC,UAAV,CAAqBC,WAArB,CAAiCC,KAFvC;AAGPK,uBAAOb,WAAWhB,EAHX;AAIP8B,sBAAM;AACFC,0BAAM,KADJ;AAEFC,2BAAO,qBAFL;AAGFC,0BAAM,wBAHJ;AAIFC,4BAAQ;AAJN;AAJC,aAAX;AAWA,4BAAMnC,IAAN,CAAW,qBAAX,6BAAsC4B,IAAtC,GACKQ,IADL,CACW,eAAO;AACV,oBAAIC,UAAUC,IAAIV,IAAlB;AACA,oBAAIS,QAAQE,IAAR,IAAiB,GAArB,EAA0B;AACtB,0BAAK5C,WAAL;AACA,0BAAKuB,UAAL;AACH,iBAHD,MAGO;AACH,0BAAKQ,OAAL,CAAaC,WAAb,CAAyBU,QAAQG,OAAjC;AACH;AACJ,aATL,EAUKC,KAVL,CAUY,eAAO;AACX,sBAAKf,OAAL,CAAaC,WAAb,CAAyB,MAAzB;AACH,aAZL;AAaH,SA/HkB;;AAEf,cAAKP,KAAL,GAAa;AACTsB,sBAAU,EADD;AAETtC,sBAAU,EAFD;AAGTR,kBAAM,CAHG;AAIToB,+BAAmB,KAJV;AAKTC,wBAAY;AALH,SAAb;;AAQA,cAAK0B,OAAL,GAAe,KAAf;AAVe;AAWlB;;;;6CAMoB;AACjB,iBAAKhD,WAAL,CAAiB,CAAjB;AACH;;;oCAGWiD,K,EAAO;AAAA;;AAAA,yBACY,KAAKxB,KADjB;AAAA,gBACPsB,QADO,UACPA,QADO;AAAA,gBACG9C,IADH,UACGA,IADH;;AAEf,4BAAMiD,GAAN,CAAU,mBAAV,EAA+B;AAC3BC,wBAAQ;AACJlD,0BAAMgD,SAAShD,IADX;AAEJmD,0BAAML;AAFF;AADmB,aAA/B,EAMCN,IAND,CAMO,eAAO;AACV,uBAAKO,OAAL,GAAe,IAAf;AACA,uBAAKxC,QAAL,CAAc;AACVC,8BAAUkC,IAAIV,IAAJ,CAASxB,QAAT,IAAqB,EADrB;AAEV4C,4BAAQV,IAAIV,IAAJ,CAASoB,MAFP;AAGVpD,0BAAM0C,IAAIV,IAAJ,CAAShC;AAHL,iBAAd;AAKH,aAbD;AAcH;;;iCAqBQK,E,EAAI;AAAA;;AACT,mBAAO,gBACFgD,MADE,mBACqBhD,EADrB,EAEFmC,IAFE,CAEI,eAAO;AACV,oBAAIE,IAAIV,IAAJ,CAASW,IAAb,EAAmB;AACf,2BAAKb,OAAL,CAAaC,WAAb,CAAyBW,IAAIV,IAAJ,CAASY,OAAlC;AACA,2BAAK7C,WAAL;AACH;AACJ,aAPE,EAQF8C,KARE,CAQK,eAAO;AACX,uBAAKf,OAAL,CAAaC,WAAb,CAAyBuB,GAAzB;AACH,aAVE,CAAP;AAWH;;;uCA0Dc;AAAA;;AAAA,gBACH9C,QADG,GACU,KAAKgB,KADf,CACHhB,QADG;;AAEX,gBAAM+C,YAAY,EAAEC,SAAS,MAAX,EAAlB;;AAEA,mBAAOhD,SAASiD,MAAT,GAAkBjD,SAASkD,GAAT,CAAc,UAACxD,OAAD,EAAWC,KAAX,EAAqB;AACpD,uBAAQ;AAAA;AAAA,sBAAK,MAAM,CAAX,EAAc,KAAKD,QAAQG,EAA3B;AACJ;AAAA;AAAA,0BAAM,OAAO;AAAA;AAAA;AAAM,gFAAM,MAAK,MAAX,GAAN;AAAA;AAA4BH,wCAAQiC,IAAR,CAAaC;AAAzC,6BAAb,EAAoE,OAAO,gDAAM,MAAK,QAAX,EAAoB,WAAU,gBAA9B,EAA+C,SAAU;AAAA,2CAAK,OAAK1B,aAAL,CAAmBR,OAAnB,CAAL;AAAA,iCAAzD,GAA3E,EAA2K,WAAWqD,SAAtL;AACI;AAAA;AAAA,8BAAS,WAAU,SAAnB,EAA6B,OAAM,wDAAnC;AAA+C;AAAA;AAAA,kCAAK,WAAU,iBAAf;AAAiC;AAAA;AAAA,sCAAG,MAAOrD,QAAQ+B,SAAR,GAAuB0B,OAAOC,QAAP,CAAgBC,MAAvC,iBAAyD3D,QAAQ+B,SAAjE,GAA+E,qBAAzF,EAAgH,WAAU,EAA1H;AAC5E;AAAA;AAAA,0CAAS,OAAOtC,UAAhB;AAA8BO,gDAAQuB;AAAtC;AAD4E;AAAjC;AAA/C,yBADJ;AAII;AAAA;AAAA,8BAAK,WAAU,yBAAf;AACI,4EAAM,MAAK,MAAX,GADJ;AACwB;AAAA;AAAA;AAAOvB,wCAAQiC,IAAR,CAAaE;AAApB,6BADxB;AAEI;AAAC,2CAAD;AAAA,kCAAa,WAAU,IAAvB;AACI;AAAA;AAAA,sCAAQ,WAAR,EAAc,MAAK,SAAnB,EAA6B,MAAK,OAAlC,EAA0C,SAAU,oBAAK;AAAE,mDAAKlB,aAAL,CAAmBjB,OAAnB;AAA6B,yCAAxF;AACI,oFAAM,MAAK,SAAX,GADJ;AAAA;AAAA,iCADJ;AAII;AAAA;AAAA,sCAAQ,WAAR,EAAc,MAAK,SAAnB,EAA6B,MAAK,OAAlC,EAA0C,SAAU,oBAAK;AAAE,mDAAKD,aAAL,CAAmBC,OAAnB,EAA4BC,KAA5B;AAAoC,yCAA/F;AACKD,4CAAQI,QAAR,GAAmB;AAAA;AAAA;AAAM,wFAAM,MAAK,KAAX,GAAN;AAAA;AAAA,qCAAnB,GAAwD;AAAA;AAAA;AAAM,wFAAM,MAAK,OAAX,GAAN;AAAA;AAAA;AAD7D;AAJJ;AAFJ;AAJJ;AADI,iBAAR;AAkBH,aAnBoB,CAAlB,GAmBE,IAnBT;AAoBH;;;iCAEQ;AAAA,0BACuE,KAAKkB,KAD5E;AAAA,gBACGhB,QADH,WACGA,QADH;AAAA,gBACaR,IADb,WACaA,IADb;AAAA,gBACmBoD,MADnB,WACmBA,MADnB;AAAA,gBAC2BN,QAD3B,WAC2BA,QAD3B;AAAA,gBACqC1B,iBADrC,WACqCA,iBADrC;AAAA,gBACwDC,UADxD,WACwDA,UADxD;;AAEL,mBACI;AAAA;AAAA,kBAAQ,WAAU,wBAAlB;AACI;AAAC,0BAAD;AAAA,sBAAQ,WAAU,iCAAlB;AACI;AAAA;AAAA;AAAA;AAAA;AADJ,iBADJ;AAII;AAAC,2BAAD;AAAA,sBAAS,WAAU,yBAAnB;AACMb,6BAASiD,MAAT,GAAkB;AAAA;AAAA,0BAAS,WAAU,eAAnB;AACd,6BAAKK,YAAL;AADc,qBAAlB,GAEW;AAAA;AAAA,0BAAG,WAAU,IAAb,EAAkB,OAAO,EAAEC,UAAU,OAAZ,EAAqBP,SAAS,SAA9B,EAAzB;AAAA;AAAA;AAHjB,iBAJJ;AASMhD,yBAASiD,MAAT,GAAkB;AAAC,0BAAD;AAAA;AAAQ,0EAAY,WAAU,IAAtB,EAA2B,qBAA3B,EAA2C,SAAUzD,IAArD,EAA6D,OAAOoD,MAApE,EAA4E,UAAW,KAAKtD,UAA5F,EAAyG,UAAUgD,QAAnH;AAAR,iBAAlB,GAAqK,IAT3K;AAUI;AAAA;AAAA;AACI,uDAAczB,WAAWc,IAAX,IAAmBd,WAAWc,IAAX,CAAgBC,IAAjD,CADJ;AAEI,iCAAShB,iBAFb;AAGI,8BAAM,KAAKG,MAHf;AAII,kCAAW,KAAKD,UAJpB;AAKI,gCAAO,cALX;AAMI,oCAAW,cANf;AAOI,8BAAO,KAPX;AAQI,4EAAc,WAAY,KAA1B,EAAkC,KAAI,YAAtC;AARJ;AAVJ,aADJ;AAuBH;;;6BAvKM0C,Y,GAAe;AAClBjC,iBAAa,oBAAUkC;AADL,C","file":"index.js","sourceRoot":"/Users/mael.liang/Workspace/node-koa-test","sourcesContent":["import React, { Component } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Layout, Icon, Card, Col, Button, Modal, Pagination, Tooltip} from 'antd';\nimport PropTypes from 'prop-types';\nimport Axios from 'axios';\nimport Masonry from 'react-masonry-component';\nimport Emojify from 'Components/Emoji';\nimport CommentInput from 'Components/CommentInput';\nimport 'Components/CommentInput/index.less';\nimport './index.less';\n\nconst { Header, Content, Footer } = Layout;\nconst ButtonGroup = Button.Group;\nconst emojiStyle = {\n    height: 20,\n};\n\nexport default class ComponentsManege extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            pageSize: 12,\n            comments: [],\n            page: 1,\n            isRepeatModalShow: false,\n            respondent: {}\n        };\n\n        this.hasLoad = false;\n    }\n\n    static contextTypes = {\n        showMessage: PropTypes.func\n    };\n\n    componentWillMount() {\n        this.getComments(1);\n    }\n\n\n    getComments(_page) {\n        const { pageSize, page } = this.state;\n        Axios.get('/api/get/comments', {\n            params: {\n                page: _page || page,\n                size: pageSize\n            }\n        })\n        .then( res => {\n            this.hasLoad = true;\n            this.setState({\n                comments: res.data.comments || [],\n                allNum: res.data.allNum,\n                page: res.data.page\n            })\n        });\n    }\n\n    changePage = page => {\n        this.getComments(page);\n    }\n\n    toggleComment = (comment, index) => {\n        Axios.post('/api/toggle/comment', {\n            id: comment.id,\n            isRemove: !comment.isRemove\n        });\n\n        this.setState( preState => {\n            let comments = preState.comments;\n            comments[index].isRemove = !comment.isRemove;\n            return {\n                comments\n            }\n        })\n    }\n\n    doDelete(id) {\n        return Axios\n            .delete(`/api/comment/${id}`)\n            .then( res => {\n                if (res.data.code) {\n                    this.context.showMessage(res.data.message);\n                    this.getComments();\n                }\n            })\n            .catch( err => {\n                this.context.showMessage(err);\n            })\n    }\n\n    deleteComment = comment => {\n        Modal.confirm({\n            title: '确定删除当前评论?',\n            content: '评论删除后不可恢复',\n            okText: '删除',\n            okType: 'danger',\n            cancelText: '取消',\n            onOk: () => {\n                return this.doDelete(comment.id);\n            }\n        });\n    }\n\n    repeatComment = comment => {\n        this.setState({\n            isRepeatModalShow: true,\n            respondent: comment\n        })\n    }\n\n    hideRepeat = () => {\n        this.setState({\n            isRepeatModalShow: false,\n        })\n    }\n\n    repeat = () => {\n        const { respondent } = this.state;\n        let commentCont = this.refs.replyInput.textareaDom.value;\n        if (!commentCont) return this.context.showMessage('请输入回复内容');\n        let data = {\n            articleid: respondent.articleid,\n            commentCont: this.refs.replyInput.textareaDom.value,\n            reply: respondent.id,\n            user: {\n                name: '记小栈',\n                email: 'mael.liang@live.com',\n                site: 'https://www.liayal.com',\n                avatar: 'https://cdn.liayal.com/image/logo_min.png'\n            }\n        }\n        Axios.post('/api/create/comment', {...data})\n            .then( res => {\n                let resdata = res.data;\n                if (resdata.code  == 200) {\n                    this.getComments();\n                    this.hideRepeat();\n                } else {\n                    this.context.showMessage(resdata.message);\n                }\n            })\n            .catch( err => {\n                this.context.showMessage('发布失败');\n            })\n    }\n\n    showComments() {\n        const { comments } = this.state;\n        const bodyStyle = { padding: '15px' };\n\n        return comments.length ? comments.map( (comment , index) => {\n                return  <Col span={8} key={comment.id} >\n                    <Card title={<span><Icon type=\"user\" /> {comment.user.name}</span>} extra={<Icon type=\"delete\" className=\"comment-delete\" onClick={ e => this.deleteComment(comment) } />} bodyStyle={bodyStyle} >\n                        <Tooltip placement=\"topLeft\" title=\"点击内容去对应文章\"><div className=\"comment-content\"><a href={ comment.articleid ? `${window.location.origin}/article/${comment.articleid}` : 'javascript:void(0);'} className=\"\">\n                            <Emojify style={emojiStyle} >{comment.commentCont}</Emojify>\n                        </a></div></Tooltip>\n                        <div className=\"comment-footer clearfix\">\n                            <Icon type=\"mail\" /><span>{comment.user.email}</span>\n                            <ButtonGroup className=\"fr\">\n                                <Button ghost type=\"primary\" size=\"small\" onClick={ e => { this.repeatComment(comment) } } >\n                                    <Icon type=\"message\" />回复\n                                </Button>\n                                <Button ghost type=\"primary\" size=\"small\" onClick={ e => { this.toggleComment(comment, index) } } >\n                                    {comment.isRemove ? <span><Icon type=\"eye\" />显示</span> : <span><Icon type=\"eye-o\" />隐藏</span>}\n                                </Button>\n                            </ButtonGroup>\n                        </div>\n                    </Card>\n                </Col>\n            }) : null;\n    }\n\n    render() {\n        const { comments, page, allNum, pageSize, isRepeatModalShow, respondent } = this.state;\n        return(\n            <Layout className=\"comments-manage-layout\">\n                <Header className='comments-manage-header clearfix' >\n                    <h2>评论管理</h2>\n                </Header>\n                <Content className=\"comments-manage-content\">\n                    { comments.length ? <Masonry className=\"comments-list\">\n                        { this.showComments() }\n                    </Masonry> : <p className=\"tc\" style={{ fontSize: '.2rem', padding: '.4rem 0'}} >~~ 暂无评论 ~~</p> }\n                </Content>\n                { comments.length ? <Footer><Pagination className='tc' showQuickJumper current={ page }  total={allNum} onChange={ this.changePage } pageSize={pageSize} /></Footer> : null}\n                <Modal\n                    title={ `回复：${respondent.user && respondent.user.name}`}\n                    visible={isRepeatModalShow}\n                    onOk={this.repeat}\n                    onCancel={ this.hideRepeat}\n                    okText='确定'\n                    cancelText='取消'\n                    mask={ false } >\n                    <CommentInput isShowBtn={ false } ref='replyInput' />\n                </Modal>\n            </Layout>\n        )\n    }\n}"]}]}