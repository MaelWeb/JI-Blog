{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[]}!/Users/mael.liang/Workspace/node-koa-test/web/page/blog/Books/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/page/blog/Books/index.js","mtime":1517274792502},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _reactRouterDom = require('react-router-dom');\n\nvar _axios = require('axios');\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Books = function (_Component) {\n    (0, _inherits3.default)(Books, _Component);\n\n    function Books(props) {\n        (0, _classCallCheck3.default)(this, Books);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (Books.__proto__ || (0, _getPrototypeOf2.default)(Books)).call(this, props));\n\n        _initialiseProps.call(_this);\n\n        var books = props.books,\n            allNum = props.allNum,\n            page = props.page,\n            allPage = props.allPage,\n            banner = props.banner;\n\n        _this.state = {\n            books: books,\n            allNum: allNum,\n            page: page,\n            allPage: allPage,\n            banner: banner,\n            isLoading: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(Books, [{\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.bookLayoutDom = _reactDom2.default.findDOMNode(this);\n            this.headerDom = _reactDom2.default.findDOMNode(this.refs.bookHeader);\n            this.blogNavDom = document.getElementById('IdNav');\n\n            window.addEventListener(\"scroll\", this.onscroll, false);\n            var books = this.state.books;\n\n\n            if (!books.length) {\n                this.getBooks(1);\n                this.getBanners();\n            }\n        }\n    }, {\n        key: 'componentWillUnmount',\n        value: function componentWillUnmount() {\n            window.removeEventListener(\"scroll\", this.onscroll);\n        }\n    }, {\n        key: 'getBanners',\n        value: function getBanners() {\n            var _this2 = this;\n\n            _axios2.default.get('/api/get/banners', {\n                params: {\n                    page: 'BOOK'\n                }\n            }).then(function (res) {\n                var resData = res.data;\n                _this2.setState({\n                    banner: resData.banners[0]\n                });\n            });\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state = this.state,\n                books = _state.books,\n                isLoading = _state.isLoading,\n                banner = _state.banner;\n\n            return _react2.default.createElement(\n                'div',\n                { className: 'blog-books-layout clearfix' },\n                _react2.default.createElement(\n                    'div',\n                    { className: 'blog-books-header', ref: 'bookHeader' },\n                    _react2.default.createElement('img', { src: '//cdn.liayal.com/image/books_banner.jpg', alt: '' }),\n                    _react2.default.createElement(\n                        'div',\n                        { className: 'text-wrap' },\n                        _react2.default.createElement(\n                            'p',\n                            null,\n                            _react2.default.createElement(\n                                'span',\n                                { style: { background: \"#B6BABD\" } },\n                                banner.text[0]\n                            ),\n                            banner.text[1]\n                        ),\n                        _react2.default.createElement(\n                            'div',\n                            { className: 'tr author' },\n                            _react2.default.createElement(\n                                'a',\n                                { href: banner.href || \"javascript:void(0);\", target: '_blank' },\n                                '\\u2014\\u2014 \\u300A',\n                                banner.author,\n                                '\\u300B'\n                            )\n                        )\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    { className: 'middle-text tc' },\n                    _react2.default.createElement(\n                        'h2',\n                        null,\n                        '\\u6742\\u800C\\u4E0D\\u7CBE\\u7684\\u8BFB\\u8005'\n                    ),\n                    _react2.default.createElement(\n                        'p',\n                        null,\n                        '\\u5F53\\u6211\\u9700\\u8981\\u5B89\\u9759\\u7684\\u65F6\\u5019\\uFF0C\\u6211\\u60F3\\u8981\\u4E00\\u672C\\u4E66\\uFF1B\\u5F53\\u6211\\u5B89\\u9759\\u7684\\u65F6\\u5019\\uFF0C\\u6211\\u66F4\\u60F3\\u8981\\u4E00\\u672C\\u4E66\\u3002\\u4E0D\\u559C\\u6B22\\u4EFB\\u4F55\\u9999\\u6C34\\u5473\\uFF0C\\u5374\\u60DF\\u72EC\\u559C\\u6B22\\u4E66\\u9999\\u5473\\u3002\\u4E00\\u672C\\u4E66\\uFF0C\\u5C31\\u662F\\u4E00\\u4E2A\\u4E16\\u754C\\u3002\\u8EB2\\u8FDB\\u8FD9\\u4E2A\\u4E16\\u754C\\u4E4B\\u4E2D\\uFF0C\\u5C31\\u53EF\\u4EE5\\u548C\\u5F53\\u4E0B\\u7684\\u4E00\\u5207\\u70E6\\u607C\\u4E0E\\u7410\\u788E\\u9694\\u79BB\\u5F00\\u6765\\u3002'\n                    )\n                ),\n                _react2.default.createElement(\n                    'div',\n                    { className: 'books-list clearfix' },\n                    books.length ? books.map(function (book) {\n                        return _react2.default.createElement(\n                            'div',\n                            { className: 'blog-books-item', key: book.id },\n                            _react2.default.createElement(\n                                'div',\n                                { className: 'books-wrap clearfix' },\n                                _react2.default.createElement(\n                                    'div',\n                                    { className: 'cover' },\n                                    _react2.default.createElement('img', { src: book.img, alt: '' })\n                                ),\n                                _react2.default.createElement(\n                                    'div',\n                                    { className: 'info' },\n                                    _react2.default.createElement(\n                                        'h4',\n                                        { className: 'title' },\n                                        book.title\n                                    ),\n                                    _react2.default.createElement(\n                                        'p',\n                                        { className: 'author' },\n                                        book.author\n                                    ),\n                                    _react2.default.createElement(\n                                        'p',\n                                        { className: 'intro' },\n                                        book.desc\n                                    ),\n                                    book.href ? _react2.default.createElement(\n                                        'div',\n                                        { className: 'btn' },\n                                        _react2.default.createElement(\n                                            'a',\n                                            { href: book.href, className: 'read-btn' },\n                                            '\\u8BD5\\u8BFB'\n                                        )\n                                    ) : null\n                                ),\n                                book.isReading ? _react2.default.createElement(\n                                    'span',\n                                    { className: 'reading' },\n                                    'Reading'\n                                ) : null\n                            )\n                        );\n                    }) : null\n                ),\n                isLoading ? _react2.default.createElement(\n                    'p',\n                    { className: 'loading' },\n                    '\\u52A0\\u8F7D\\u4E2D...'\n                ) : null\n            );\n        }\n    }]);\n    return Books;\n}(_react.Component);\n\nBooks.defaultProps = {\n    books: [],\n    page: 0,\n    allPage: 0,\n    banner: {\n        text: ['这个世界上的每样东西都生死未定，都充满了风险，那些不接受风险的人，那些不了解命运的人，在角落里日渐衰落。', '我忽然明白为什么我没能拥有尼诺，而莉拉能够拥有他。我不能追随那些真实的感情，我无法使自己打破陈规旧矩，我没有莉拉那么强烈的情感，她可以不顾一切去享受那一天一夜。'],\n        author: '新名字的故事'\n    }\n};\n\nvar _initialiseProps = function _initialiseProps() {\n    var _this3 = this;\n\n    this.onscroll = function (e) {\n        e = e || window.event;\n        var _scrollTop = window.pageYOffset || document.documentElement && document.documentElement.scrollTop || document.body.scrollTop || 0;\n\n        var _state2 = _this3.state,\n            page = _state2.page,\n            allPage = _state2.allPage;\n\n        if (_scrollTop + document.documentElement.clientHeight > _this3.bookLayoutDom.offsetHeight - 200) {\n            page < allPage && _this3.getBooks(page + 1);\n        }\n    };\n\n    this.getBooks = function (_page) {\n        if (_this3.state.isLoading) return;\n        _this3.setState({\n            isLoading: true\n        });\n        _axios2.default.get('/api/get/books', {\n            params: {\n                page: _page\n            }\n        }).then(function (res) {\n            var resData = res.data;\n            _this3.setState(function (preState) {\n                var books = preState.books.concat(resData.books);\n                return {\n                    books: books,\n                    allNum: resData.allNum,\n                    page: resData.page,\n                    allPage: resData.allPage,\n                    isLoading: false\n                };\n            });\n        });\n    };\n};\n\nexports.default = Books;",null]}