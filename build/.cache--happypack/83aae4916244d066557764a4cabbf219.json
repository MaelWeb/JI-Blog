{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[]}!/Users/mael.liang/Workspace/node-koa-test/web/page/admin/UserInfo/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/page/admin/UserInfo/index.js","mtime":1519640481012},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _modal = require('antd/lib/modal');\n\nvar _modal2 = _interopRequireDefault(_modal);\n\nvar _input = require('antd/lib/input');\n\nvar _input2 = _interopRequireDefault(_input);\n\nvar _button = require('antd/lib/button');\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _layout = require('antd/lib/layout');\n\nvar _layout2 = _interopRequireDefault(_layout);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _axios = require('axios');\n\nvar _axios2 = _interopRequireDefault(_axios);\n\nvar _jsCookie = require('js-cookie');\n\nvar _jsCookie2 = _interopRequireDefault(_jsCookie);\n\nrequire('./index.less');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar Header = _layout2.default.Header,\n    Content = _layout2.default.Content;\n\nvar UserInfo = function (_Component) {\n    (0, _inherits3.default)(UserInfo, _Component);\n\n    function UserInfo(props) {\n        (0, _classCallCheck3.default)(this, UserInfo);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (UserInfo.__proto__ || (0, _getPrototypeOf2.default)(UserInfo)).call(this, props));\n\n        _this.modalOk = function () {\n            var name = _this.refs.ModalInput.input.value;\n\n            if (!name) return _this.context.showMessage(\"请输入昵称\");\n\n            _axios2.default.post('/api/update/userinfo', { name: name }).then(function (res) {\n                _this.context.showMessage(res.data.message);\n\n                if (res.data.code == 200) {\n                    _this.setState(function (preState) {\n                        var userInfo = preState.userInfo;\n                        userInfo.name = name;\n\n                        return { userInfo: userInfo, showModal: false };\n                    });\n                }\n            });\n        };\n\n        _this.setNickName = function () {\n            _this.setState({\n                showModal: true\n            });\n        };\n\n        _this.hideModal = function () {\n            _this.setState({\n                showModal: false\n            });\n        };\n\n        _this.logout = function () {\n            _jsCookie2.default.remove('access_token');\n            _jsCookie2.default.remove('uid');\n            _this.props.history.push('/login');\n        };\n\n        _this.state = {\n            userInfo: {},\n            showModal: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(UserInfo, [{\n        key: 'componentWillMount',\n        value: function componentWillMount() {\n            var _this2 = this;\n\n            _axios2.default.get('/api/get/userinfo').then(function (res) {\n                _this2.setState({\n                    userInfo: res.data.user\n                });\n            });\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state = this.state,\n                userInfo = _state.userInfo,\n                showModal = _state.showModal;\n\n            return _react2.default.createElement(\n                _layout2.default,\n                { className: 'userinfo-layout' },\n                _react2.default.createElement(\n                    Header,\n                    { className: 'userinfo-header clearfix' },\n                    _react2.default.createElement(\n                        'h3',\n                        null,\n                        '\\u8D26\\u53F7\\u8BBE\\u7F6E'\n                    ),\n                    _react2.default.createElement(\n                        _button2.default,\n                        { className: 'fr logout', onClick: this.logout },\n                        '\\u9000\\u51FA\\u767B\\u5F55'\n                    )\n                ),\n                _react2.default.createElement(\n                    Content,\n                    { className: 'userinfo-manage-content' },\n                    _react2.default.createElement(\n                        'div',\n                        { className: 'userinfo-body' },\n                        _react2.default.createElement(\n                            'div',\n                            { className: 'info' },\n                            _react2.default.createElement(\n                                'h4',\n                                null,\n                                '\\u4FE1\\u606F'\n                            ),\n                            _react2.default.createElement(\n                                'div',\n                                { className: 'info-box' },\n                                _react2.default.createElement(\n                                    'span',\n                                    { className: 'label' },\n                                    '\\u6635\\u79F0\\uFF1A'\n                                ),\n                                _react2.default.createElement(\n                                    'span',\n                                    { className: 'text' },\n                                    userInfo.name || '----'\n                                ),\n                                _react2.default.createElement(\n                                    _button2.default,\n                                    { type: 'primary', size: 'small', onClick: this.setNickName },\n                                    userInfo.name ? '修改昵称' : '设置昵称'\n                                )\n                            ),\n                            _react2.default.createElement(\n                                'div',\n                                { className: 'info-box' },\n                                _react2.default.createElement(\n                                    'span',\n                                    { className: 'label' },\n                                    '\\u90AE\\u7BB1\\uFF1A'\n                                ),\n                                _react2.default.createElement(\n                                    'span',\n                                    { className: 'text' },\n                                    userInfo.email\n                                )\n                            )\n                        )\n                    )\n                ),\n                _react2.default.createElement(\n                    _modal2.default,\n                    {\n                        title: '\\u8BBE\\u7F6E\\uFF0F\\u4FEE\\u6539\\u6635\\u79F0',\n                        visible: showModal,\n                        onOk: this.modalOk,\n                        onCancel: this.hideModal,\n                        okText: '\\u786E\\u5B9A',\n                        cancelText: '\\u53D6\\u6D88'\n                    },\n                    _react2.default.createElement(_input2.default, { ref: 'ModalInput', placeholder: '\\u8BF7\\u8F93\\u5165\\u6635\\u79F0' })\n                )\n            );\n        }\n    }]);\n    return UserInfo;\n}(_react.Component);\n\nUserInfo.contextTypes = {\n    showMessage: _propTypes2.default.func\n};\nexports.default = UserInfo;",null]}