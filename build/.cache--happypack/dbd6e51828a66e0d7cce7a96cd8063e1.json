{"remainingRequest":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js?{\"presets\":[\"react-hmre\"]}!/Users/mael.liang/Workspace/node-koa-test/web/components/ImageGallery/index.js","dependencies":[{"path":"/Users/mael.liang/Workspace/node-koa-test/web/components/ImageGallery/index.js","mtime":1512366771000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/cache-loader/dist/cjs.js","mtime":1510929699000},{"path":"/Users/mael.liang/Workspace/node-koa-test/node_modules/babel-loader/lib/index.js","mtime":1503096278000}],"contextDependencies":[],"result":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _assign = require('babel-runtime/core-js/object/assign');\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nvar _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _index = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/redbox-react/lib/index.js');\n\nvar _index2 = _interopRequireDefault(_index);\n\nvar _index3 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-catch-errors/lib/index.js');\n\nvar _index4 = _interopRequireDefault(_index3);\n\nvar _react2 = require('react');\n\nvar _react3 = _interopRequireDefault(_react2);\n\nvar _index5 = require('/Users/mael.liang/Workspace/node-koa-test/node_modules/react-transform-hmr/lib/index.js');\n\nvar _index6 = _interopRequireDefault(_index5);\n\nvar _class, _temp;\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _Toucher = require('../Toucher');\n\nvar _Toucher2 = _interopRequireDefault(_Toucher);\n\nvar _Icon = require('../Icon');\n\nvar _Icon2 = _interopRequireDefault(_Icon);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _components = {\n    ImageGallery: {\n        displayName: 'ImageGallery'\n    }\n};\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/components/ImageGallery/index.js',\n    components: _components,\n    locals: [module],\n    imports: [_react3.default]\n});\n\nvar _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({\n    filename: '/Users/mael.liang/Workspace/node-koa-test/web/components/ImageGallery/index.js',\n    components: _components,\n    locals: [],\n    imports: [_react3.default, _index2.default]\n});\n\nfunction _wrapComponent(id) {\n    return function (Component) {\n        return _UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformHmrLibIndexJs2(_UsersMaelLiangWorkspaceNodeKoaTestNode_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);\n    };\n}\n\nvar ImageGallery = _wrapComponent('ImageGallery')((_temp = _class = function (_Component) {\n    (0, _inherits3.default)(ImageGallery, _Component);\n\n    function ImageGallery(props) {\n        (0, _classCallCheck3.default)(this, ImageGallery);\n\n        var _this = (0, _possibleConstructorReturn3.default)(this, (ImageGallery.__proto__ || (0, _getPrototypeOf2.default)(ImageGallery)).call(this, props));\n\n        _this.preventDefault = function (e) {\n            e.preventDefault();\n        };\n\n        _this.close = function () {\n            _this.setState({\n                isShow: false\n            });\n        };\n\n        _this._onSliding = function () {\n            var isTransitioning = _this.state.isTransitioning;\n\n            window.setTimeout(function () {\n                if (isTransitioning) {\n                    _this.setState({ isTransitioning: !isTransitioning });\n                }\n            }, _this.props.slideDuration);\n        };\n\n        _this.slideToIndex = function (index, event) {\n            var _this$state = _this.state,\n                currentIndex = _this$state.currentIndex,\n                isTransitioning = _this$state.isTransitioning;\n\n\n            if (!isTransitioning) {\n\n                var slideCount = _this.props.images.length - 1;\n                var nextIndex = index;\n\n                if (index < 0) {\n                    nextIndex = slideCount;\n                } else if (index > slideCount) {\n                    nextIndex = 0;\n                }\n\n                _this.setState({\n                    previousIndex: currentIndex,\n                    currentIndex: nextIndex,\n                    isTransitioning: nextIndex !== currentIndex,\n                    offsetPercentage: 0,\n                    style: {\n                        transition: 'all ' + _this.props.slideDuration + 'ms ease-out'\n                    }\n                }, _this._onSliding);\n            }\n        };\n\n        _this.slideLeft = function (event) {\n            _this.slideToIndex(_this.state.currentIndex - 1, event);\n        };\n\n        _this.slideRight = function (event) {\n            _this.slideToIndex(_this.state.currentIndex + 1, event);\n        };\n\n        _this._getSlideStyle = function (index) {\n            var _this$state2 = _this.state,\n                currentIndex = _this$state2.currentIndex,\n                offsetPercentage = _this$state2.offsetPercentage;\n            var images = _this.props.images;\n\n            var baseTranslateX = -100 * currentIndex;\n            var totalSlides = images.length - 1;\n\n            // calculates where the other slides belong based on currentIndex\n            var translateX = baseTranslateX + index * 100 + offsetPercentage;\n\n            if (images.length > 2) {\n                if (currentIndex === 0 && index === totalSlides) {\n                    // make the last slide the slide before the first\n                    translateX = -100 + offsetPercentage;\n                } else if (currentIndex === totalSlides && index === 0) {\n                    // make the first slide the slide after the last\n                    translateX = 100 + offsetPercentage;\n                }\n            }\n\n            // Special case when there are only 2 images with infinite on\n            if (images.length === 2) {\n                translateX = _this._getTranslateXForTwoSlide(index);\n            }\n\n            var translate = 'translate(' + translateX + '%, 0)';\n\n            return {\n                WebkitTransform: translate,\n                MozTransform: translate,\n                msTransform: translate,\n                OTransform: translate,\n                transform: translate\n            };\n        };\n\n        _this.state = {\n            currentIndex: props.startIndex,\n            offsetPercentage: 0,\n            isShow: false\n        };\n        return _this;\n    }\n\n    (0, _createClass3.default)(ImageGallery, [{\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextProps) {\n            if (nextProps.startIndex >= nextProps.images.length) {\n                this.setState({\n                    currentIndex: 0,\n                    isShow: nextProps.isShow\n                });\n            } else {\n                this.setState({\n                    currentIndex: nextProps.startIndex,\n                    isShow: nextProps.isShow\n                });\n            }\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            if (_reactDom2.default.findDOMNode(this)) {\n                this.dom = _reactDom2.default.findDOMNode(this);\n                this.dom.addEventListener('touchmove', this.preventDefault);\n            }\n        }\n    }, {\n        key: '_shouldPushSlideOnInfiniteMode',\n        value: function _shouldPushSlideOnInfiniteMode(index) {\n            /*\n              Push(show) slide if slide is the current slide, and the next slide\n              OR\n              The slide is going more than 1 slide left, or right, but not going from\n              first to last and not going from last to first\n              There is an edge case where if you go to the first or last slide, when they're\n              not left, or right of each other they will try to catch up in the background\n              so unless were going from first to last or vice versa we don't want the first\n              or last slide to show up during our transition\n            */\n            return !this._slideIsTransitioning(index) || this._ignoreIsTransitioning() && !this._isFirstOrLastSlide(index);\n        }\n    }, {\n        key: '_slideIsTransitioning',\n        value: function _slideIsTransitioning(index) {\n            /*\n            returns true if the gallery is transitioning and the index is not the\n            previous or currentIndex\n            */\n            var _state = this.state,\n                isTransitioning = _state.isTransitioning,\n                previousIndex = _state.previousIndex,\n                currentIndex = _state.currentIndex;\n\n            var indexIsNotPreviousOrNextSlide = !(index === previousIndex || index === currentIndex);\n            return isTransitioning && indexIsNotPreviousOrNextSlide;\n        }\n    }, {\n        key: '_isFirstOrLastSlide',\n        value: function _isFirstOrLastSlide(index) {\n            var totalSlides = this.props.images.length - 1;\n            var isLastSlide = index === totalSlides;\n            var isFirstSlide = index === 0;\n            return isLastSlide || isFirstSlide;\n        }\n    }, {\n        key: '_ignoreIsTransitioning',\n        value: function _ignoreIsTransitioning() {\n            /*\n              Ignore isTransitioning because were not going to sibling slides\n              e.g. center to left or center to right\n            */\n            var _state2 = this.state,\n                previousIndex = _state2.previousIndex,\n                currentIndex = _state2.currentIndex;\n\n            var totalSlides = this.props.images.length - 1;\n            // we want to show the in between slides transition\n            var slidingMoreThanOneSlideLeftOrRight = Math.abs(previousIndex - currentIndex) > 1;\n            var notGoingFromFirstToLast = !(previousIndex === 0 && currentIndex === totalSlides);\n            var notGoingFromLastToFirst = !(previousIndex === totalSlides && currentIndex === 0);\n\n            return slidingMoreThanOneSlideLeftOrRight && notGoingFromFirstToLast && notGoingFromLastToFirst;\n        }\n    }, {\n        key: 'getSlides',\n        value: function getSlides() {\n            var _this2 = this;\n\n            var slides = [];\n            var images = this.props.images;\n            var currentIndex = this.state.currentIndex;\n\n\n            images.length && images.map(function (img, index) {\n                if (_this2._shouldPushSlideOnInfiniteMode(index)) {\n                    var slideStyle = _this2._getSlideStyle(index);\n                    slides.push(_react3.default.createElement(\n                        'div',\n                        { className: 'image-gallery-slide', style: (0, _assign2.default)(slideStyle, _this2.state.style), key: index },\n                        _react3.default.createElement('img', { src: img.src })\n                    ));\n                }\n            });\n\n            return slides;\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            var _state3 = this.state,\n                isShow = _state3.isShow,\n                currentIndex = _state3.currentIndex;\n            var images = this.props.images;\n\n            return _react3.default.createElement(\n                'div',\n                { className: 'mael-image-gallery', hidden: !isShow },\n                _react3.default.createElement(_Icon2.default, { type: 'close', onClick: this.close }),\n                _react3.default.createElement(\n                    _Toucher2.default,\n                    { className: 'image-gallery-swipe', onSwipeRight: this.slideLeft, onSwipeLeft: this.slideRight },\n                    _react3.default.createElement(\n                        'div',\n                        { className: 'image-gallery-arrow arrow-left', onClick: this.slideLeft },\n                        _react3.default.createElement(_Icon2.default, { type: 'bold-arrow-left' })\n                    ),\n                    _react3.default.createElement(\n                        'div',\n                        { className: 'image-gallery-slides' },\n                        this.getSlides()\n                    ),\n                    _react3.default.createElement(\n                        'div',\n                        { className: 'image-gallery-arrow arrow-right', onClick: this.slideRight },\n                        _react3.default.createElement(_Icon2.default, { type: 'bold-arrow-right' })\n                    )\n                ),\n                _react3.default.createElement(\n                    'p',\n                    { className: 'image-index tc' },\n                    currentIndex + 1,\n                    '/',\n                    images.length\n                )\n            );\n        }\n    }]);\n    return ImageGallery;\n}(_react2.Component), _class.propTypes = {\n    startIndex: _propTypes2.default.number,\n    images: _propTypes2.default.array,\n    slideDuration: _propTypes2.default.number\n}, _class.defaultProps = {\n    startIndex: 0,\n    images: [],\n    slideDuration: 450\n}, _temp));\n\nexports.default = ImageGallery;",{"version":3,"sources":["web/components/ImageGallery/index.js"],"names":["props","preventDefault","e","close","setState","isShow","_onSliding","isTransitioning","state","window","setTimeout","slideDuration","slideToIndex","index","event","currentIndex","slideCount","images","length","nextIndex","previousIndex","offsetPercentage","style","transition","slideLeft","slideRight","_getSlideStyle","baseTranslateX","totalSlides","translateX","_getTranslateXForTwoSlide","translate","WebkitTransform","MozTransform","msTransform","OTransform","transform","startIndex","nextProps","findDOMNode","dom","addEventListener","_slideIsTransitioning","_ignoreIsTransitioning","_isFirstOrLastSlide","indexIsNotPreviousOrNextSlide","isLastSlide","isFirstSlide","slidingMoreThanOneSlideLeftOrRight","Math","abs","notGoingFromFirstToLast","notGoingFromLastToFirst","slides","map","img","_shouldPushSlideOnInfiniteMode","slideStyle","push","src","getSlides","propTypes","number","array","defaultProps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGI,0BAAYA,KAAZ,EAAmB;AAAA;;AAAA,sJACTA,KADS;;AAAA,cA4CnBC,cA5CmB,GA4CF,UAACC,CAAD,EAAO;AACnBA,cAAED,cAAF;AACJ,SA9CkB;;AAAA,cAgDnBE,KAhDmB,GAgDX,YAAM;AACV,kBAAKC,QAAL,CAAc;AACVC,wBAAO;AADG,aAAd;AAGH,SApDkB;;AAAA,cAsDnBC,UAtDmB,GAsDN,YAAM;AAAA,gBACRC,eADQ,GACY,MAAKC,KADjB,CACRD,eADQ;;AAEfE,mBAAOC,UAAP,CAAkB,YAAM;AACpB,oBAAIH,eAAJ,EAAqB;AACjB,0BAAKH,QAAL,CAAc,EAACG,iBAAiB,CAACA,eAAnB,EAAd;AACH;AACJ,aAJD,EAIG,MAAKP,KAAL,CAAWW,aAJd;AAKH,SA7DkB;;AAAA,cA+DnBC,YA/DmB,GA+DJ,UAACC,KAAD,EAAQC,KAAR,EAAkB;AAAA,8BACW,MAAKN,KADhB;AAAA,gBACtBO,YADsB,eACtBA,YADsB;AAAA,gBACRR,eADQ,eACRA,eADQ;;;AAG7B,gBAAI,CAACA,eAAL,EAAsB;;AAElB,oBAAIS,aAAa,MAAKhB,KAAL,CAAWiB,MAAX,CAAkBC,MAAlB,GAA2B,CAA5C;AACA,oBAAIC,YAAYN,KAAhB;;AAEA,oBAAIA,QAAQ,CAAZ,EAAe;AACXM,gCAAYH,UAAZ;AACH,iBAFD,MAEO,IAAIH,QAAQG,UAAZ,EAAwB;AAC3BG,gCAAY,CAAZ;AACH;;AAED,sBAAKf,QAAL,CAAc;AACVgB,mCAAeL,YADL;AAEVA,kCAAcI,SAFJ;AAGVZ,qCAAiBY,cAAcJ,YAHrB;AAIVM,sCAAkB,CAJR;AAKVC,2BAAO;AACLC,6CAAmB,MAAKvB,KAAL,CAAWW,aAA9B;AADK;AALG,iBAAd,EAQG,MAAKL,UARR;AASH;AACJ,SAvFkB;;AAAA,cAyFnBkB,SAzFmB,GAyFP,UAACV,KAAD,EAAW;AACnB,kBAAKF,YAAL,CAAkB,MAAKJ,KAAL,CAAWO,YAAX,GAA0B,CAA5C,EAA+CD,KAA/C;AACH,SA3FkB;;AAAA,cA6FnBW,UA7FmB,GA6FN,UAACX,KAAD,EAAW;AACpB,kBAAKF,YAAL,CAAkB,MAAKJ,KAAL,CAAWO,YAAX,GAA0B,CAA5C,EAA+CD,KAA/C;AACH,SA/FkB;;AAAA,cAiGnBY,cAjGmB,GAiGF,UAACb,KAAD,EAAW;AAAA,+BACiB,MAAKL,KADtB;AAAA,gBACjBO,YADiB,gBACjBA,YADiB;AAAA,gBACHM,gBADG,gBACHA,gBADG;AAAA,gBAEjBJ,MAFiB,GAEP,MAAKjB,KAFE,CAEjBiB,MAFiB;;AAGxB,gBAAMU,iBAAiB,CAAC,GAAD,GAAOZ,YAA9B;AACA,gBAAMa,cAAcX,OAAOC,MAAP,GAAgB,CAApC;;AAEA;AACA,gBAAIW,aAAaF,iBAAkBd,QAAQ,GAA1B,GAAiCQ,gBAAlD;;AAEA,gBAAIJ,OAAOC,MAAP,GAAgB,CAApB,EAAuB;AACnB,oBAAIH,iBAAiB,CAAjB,IAAsBF,UAAUe,WAApC,EAAiD;AAC7C;AACAC,iCAAa,CAAC,GAAD,GAAOR,gBAApB;AACH,iBAHD,MAGO,IAAIN,iBAAiBa,WAAjB,IAAgCf,UAAU,CAA9C,EAAiD;AACxD;AACIgB,iCAAa,MAAMR,gBAAnB;AACH;AACJ;;AAED;AACA,gBAAIJ,OAAOC,MAAP,KAAkB,CAAtB,EAAyB;AACrBW,6BAAa,MAAKC,yBAAL,CAA+BjB,KAA/B,CAAb;AACH;;AAED,gBAAMkB,2BAAyBF,UAAzB,UAAN;;AAEA,mBAAO;AACHG,iCAAiBD,SADd;AAEHE,8BAAcF,SAFX;AAGHG,6BAAaH,SAHV;AAIHI,4BAAYJ,SAJT;AAKHK,2BAAWL;AALR,aAAP;AAOH,SAlIkB;;AAGf,cAAKvB,KAAL,GAAa;AACTO,0BAAcf,MAAMqC,UADX;AAEThB,8BAAkB,CAFT;AAGThB,oBAAQ;AAHC,SAAb;AAHe;AAQlB;;;;kDAeyBiC,S,EAAW;AACjC,gBAAIA,UAAUD,UAAV,IAAwBC,UAAUrB,MAAV,CAAiBC,MAA7C,EAAqD;AACjD,qBAAKd,QAAL,CAAc;AACVW,kCAAc,CADJ;AAEVV,4BAAQiC,UAAUjC;AAFR,iBAAd;AAIH,aALD,MAKO;AACH,qBAAKD,QAAL,CAAc;AACVW,kCAAcuB,UAAUD,UADd;AAEVhC,4BAAQiC,UAAUjC;AAFR,iBAAd;AAIH;AACJ;;;4CAEmB;AAChB,gBAAI,mBAASkC,WAAT,CAAqB,IAArB,CAAJ,EAAgC;AAC5B,qBAAKC,GAAL,GAAW,mBAASD,WAAT,CAAqB,IAArB,CAAX;AACA,qBAAKC,GAAL,CAASC,gBAAT,CAA0B,WAA1B,EAAuC,KAAKxC,cAA5C;AACH;AACJ;;;uDA0F8BY,K,EAAO;AAClC;;;;;;;;;;AAUA,mBAAO,CAAC,KAAK6B,qBAAL,CAA2B7B,KAA3B,CAAD,IACJ,KAAK8B,sBAAL,MAAiC,CAAC,KAAKC,mBAAL,CAAyB/B,KAAzB,CADrC;AAEH;;;8CAEqBA,K,EAAO;AACzB;;;;AADyB,yBAKgC,KAAKL,KALrC;AAAA,gBAKjBD,eALiB,UAKjBA,eALiB;AAAA,gBAKAa,aALA,UAKAA,aALA;AAAA,gBAKeL,YALf,UAKeA,YALf;;AAMzB,gBAAM8B,gCAAgC,EAAEhC,UAAUO,aAAV,IAA2BP,UAAUE,YAAvC,CAAtC;AACA,mBAAOR,mBAAmBsC,6BAA1B;AACH;;;4CAEmBhC,K,EAAO;AACvB,gBAAMe,cAAc,KAAK5B,KAAL,CAAWiB,MAAX,CAAkBC,MAAlB,GAA2B,CAA/C;AACA,gBAAM4B,cAAcjC,UAAUe,WAA9B;AACA,gBAAMmB,eAAelC,UAAU,CAA/B;AACA,mBAAOiC,eAAeC,YAAtB;AACH;;;iDAEwB;AACrB;;;;AADqB,0BAKmB,KAAKvC,KALxB;AAAA,gBAKbY,aALa,WAKbA,aALa;AAAA,gBAKEL,YALF,WAKEA,YALF;;AAMrB,gBAAMa,cAAc,KAAK5B,KAAL,CAAWiB,MAAX,CAAkBC,MAAlB,GAA2B,CAA/C;AACA;AACA,gBAAM8B,qCAAqCC,KAAKC,GAAL,CAAS9B,gBAAgBL,YAAzB,IAAyC,CAApF;AACA,gBAAMoC,0BAA0B,EAAE/B,kBAAkB,CAAlB,IAAuBL,iBAAiBa,WAA1C,CAAhC;AACA,gBAAMwB,0BAA0B,EAAEhC,kBAAkBQ,WAAlB,IAAiCb,iBAAiB,CAApD,CAAhC;;AAEA,mBAAOiC,sCACLG,uBADK,IAELC,uBAFF;AAGH;;;oCAGW;AAAA;;AACR,gBAAIC,SAAS,EAAb;AADQ,gBAEApC,MAFA,GAEW,KAAKjB,KAFhB,CAEAiB,MAFA;AAAA,gBAGAF,YAHA,GAGiB,KAAKP,KAHtB,CAGAO,YAHA;;;AAKRE,mBAAOC,MAAP,IAAiBD,OAAOqC,GAAP,CAAW,UAACC,GAAD,EAAM1C,KAAN,EAAgB;AACxC,oBAAI,OAAK2C,8BAAL,CAAoC3C,KAApC,CAAJ,EAAgD;AAC5C,wBAAI4C,aAAa,OAAK/B,cAAL,CAAoBb,KAApB,CAAjB;AACAwC,2BAAOK,IAAP,CACK;AAAA;AAAA,0BAAK,WAAU,qBAAf,EAAqC,OAAQ,sBAAcD,UAAd,EAA0B,OAAKjD,KAAL,CAAWc,KAArC,CAA7C,EAA2F,KAAKT,KAAhG;AACG,+DAAK,KAAK0C,IAAII,GAAd;AADH,qBADL;AAKH;AACJ,aATgB,CAAjB;;AAWA,mBAAON,MAAP;AACH;;;iCAEQ;AAAA,0BAC4B,KAAK7C,KADjC;AAAA,gBACGH,MADH,WACGA,MADH;AAAA,gBACWU,YADX,WACWA,YADX;AAAA,gBAEGE,MAFH,GAEc,KAAKjB,KAFnB,CAEGiB,MAFH;;AAGL,mBACI;AAAA;AAAA,kBAAK,WAAU,oBAAf,EAAoC,QAAQ,CAACZ,MAA7C;AACI,gEAAM,MAAK,OAAX,EAAmB,SAAU,KAAKF,KAAlC,GADJ;AAEI;AAAA;AAAA,sBAAS,WAAU,qBAAnB,EAAyC,cAAe,KAAKqB,SAA7D,EAAyE,aAAc,KAAKC,UAA5F;AACI;AAAA;AAAA,0BAAK,WAAU,gCAAf,EAAgD,SAAU,KAAKD,SAA/D;AAA4E,wEAAM,MAAK,iBAAX;AAA5E,qBADJ;AAEI;AAAA;AAAA,0BAAK,WAAU,sBAAf;AACM,6BAAKoC,SAAL;AADN,qBAFJ;AAKI;AAAA;AAAA,0BAAK,WAAU,iCAAf,EAAiD,SAAU,KAAKnC,UAAhE;AAA8E,wEAAM,MAAK,kBAAX;AAA9E;AALJ,iBAFJ;AASI;AAAA;AAAA,sBAAG,WAAU,gBAAb;AAA+BV,mCAAe,CAA9C;AAAA;AAAmDE,2BAAOC;AAA1D;AATJ,aADJ;AAaH;;;6BA/MM2C,S,GAAY;AACfxB,gBAAY,oBAAUyB,MADP;AAEf7C,YAAQ,oBAAU8C,KAFH;AAGfpD,mBAAe,oBAAUmD;AAHV,C,SAMZE,Y,GAAe;AAClB3B,gBAAY,CADM;AAElBpB,YAAQ,EAFU;AAGlBN,mBAAe;AAHG,C","file":"index.js","sourceRoot":"/Users/mael.liang/Workspace/node-koa-test","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport Toucher from '../Toucher';\nimport Icon from '../Icon';\nimport PropTypes from 'prop-types';\nimport ClassNames from 'classnames';\n\nexport default class ImageGallery extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            currentIndex: props.startIndex,\n            offsetPercentage: 0,\n            isShow: false\n        }\n    }\n\n    static propTypes = {\n        startIndex: PropTypes.number,\n        images: PropTypes.array,\n        slideDuration: PropTypes.number\n    };\n\n    static defaultProps = {\n        startIndex: 0,\n        images: [],\n        slideDuration: 450\n    };\n\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.startIndex >= nextProps.images.length) {\n            this.setState({\n                currentIndex: 0,\n                isShow: nextProps.isShow\n            })\n        } else {\n            this.setState({\n                currentIndex: nextProps.startIndex,\n                isShow: nextProps.isShow\n            })\n        }\n    }\n\n    componentDidMount() {\n        if (ReactDOM.findDOMNode(this)) {\n            this.dom = ReactDOM.findDOMNode(this);\n            this.dom.addEventListener('touchmove', this.preventDefault);\n        }\n    }\n\n    preventDefault = (e) => {\n         e.preventDefault();\n    }\n\n    close = () => {\n        this.setState({\n            isShow:false\n        })\n    }\n\n    _onSliding = () => {\n       const { isTransitioning } = this.state;\n        window.setTimeout(() => {\n            if (isTransitioning) {\n                this.setState({isTransitioning: !isTransitioning});\n            }\n        }, this.props.slideDuration);\n    };\n\n    slideToIndex = (index, event) => {\n        const {currentIndex, isTransitioning} = this.state;\n\n        if (!isTransitioning) {\n\n            let slideCount = this.props.images.length - 1;\n            let nextIndex = index;\n\n            if (index < 0) {\n                nextIndex = slideCount;\n            } else if (index > slideCount) {\n                nextIndex = 0;\n            }\n\n            this.setState({\n                previousIndex: currentIndex,\n                currentIndex: nextIndex,\n                isTransitioning: nextIndex !== currentIndex,\n                offsetPercentage: 0,\n                style: {\n                  transition: `all ${this.props.slideDuration}ms ease-out`\n                }\n            }, this._onSliding);\n        }\n    }\n\n    slideLeft = (event) => {\n        this.slideToIndex(this.state.currentIndex - 1, event);\n    }\n\n    slideRight = (event) => {\n        this.slideToIndex(this.state.currentIndex + 1, event);\n    }\n\n    _getSlideStyle = (index) => {\n        const {currentIndex, offsetPercentage} = this.state;\n        const {images} = this.props;\n        const baseTranslateX = -100 * currentIndex;\n        const totalSlides = images.length - 1;\n\n        // calculates where the other slides belong based on currentIndex\n        let translateX = baseTranslateX + (index * 100) + offsetPercentage;\n\n        if (images.length > 2) {\n            if (currentIndex === 0 && index === totalSlides) {\n                // make the last slide the slide before the first\n                translateX = -100 + offsetPercentage;\n            } else if (currentIndex === totalSlides && index === 0) {\n            // make the first slide the slide after the last\n                translateX = 100 + offsetPercentage;\n            }\n        }\n\n        // Special case when there are only 2 images with infinite on\n        if (images.length === 2) {\n            translateX = this._getTranslateXForTwoSlide(index);\n        }\n\n        const translate = `translate(${translateX}%, 0)`;\n\n        return {\n            WebkitTransform: translate,\n            MozTransform: translate,\n            msTransform: translate,\n            OTransform: translate,\n            transform: translate,\n        };\n    };\n\n    _shouldPushSlideOnInfiniteMode(index) {\n        /*\n          Push(show) slide if slide is the current slide, and the next slide\n          OR\n          The slide is going more than 1 slide left, or right, but not going from\n          first to last and not going from last to first\n          There is an edge case where if you go to the first or last slide, when they're\n          not left, or right of each other they will try to catch up in the background\n          so unless were going from first to last or vice versa we don't want the first\n          or last slide to show up during our transition\n        */\n        return !this._slideIsTransitioning(index) ||\n          (this._ignoreIsTransitioning() && !this._isFirstOrLastSlide(index));\n    }\n\n    _slideIsTransitioning(index) {\n        /*\n        returns true if the gallery is transitioning and the index is not the\n        previous or currentIndex\n        */\n        const { isTransitioning, previousIndex, currentIndex } = this.state;\n        const indexIsNotPreviousOrNextSlide = !(index === previousIndex || index === currentIndex);\n        return isTransitioning && indexIsNotPreviousOrNextSlide;\n    }\n\n    _isFirstOrLastSlide(index) {\n        const totalSlides = this.props.images.length - 1;\n        const isLastSlide = index === totalSlides;\n        const isFirstSlide = index === 0;\n        return isLastSlide || isFirstSlide;\n    }\n\n    _ignoreIsTransitioning() {\n        /*\n          Ignore isTransitioning because were not going to sibling slides\n          e.g. center to left or center to right\n        */\n        const { previousIndex, currentIndex } = this.state;\n        const totalSlides = this.props.images.length - 1;\n        // we want to show the in between slides transition\n        const slidingMoreThanOneSlideLeftOrRight = Math.abs(previousIndex - currentIndex) > 1;\n        const notGoingFromFirstToLast = !(previousIndex === 0 && currentIndex === totalSlides);\n        const notGoingFromLastToFirst = !(previousIndex === totalSlides && currentIndex === 0);\n\n        return slidingMoreThanOneSlideLeftOrRight &&\n          notGoingFromFirstToLast &&\n          notGoingFromLastToFirst;\n    }\n\n\n    getSlides() {\n        let slides = [];\n        const { images } = this.props;\n        const { currentIndex } = this.state;\n\n        images.length && images.map((img, index) => {\n            if (this._shouldPushSlideOnInfiniteMode(index)) {\n                let slideStyle = this._getSlideStyle(index);\n                slides.push(\n                    (<div className='image-gallery-slide' style={ Object.assign(slideStyle, this.state.style) } key={index} >\n                        <img src={img.src}/>\n                    </div>)\n                );\n            }\n        })\n\n        return slides;\n    }\n\n    render() {\n        const { isShow, currentIndex } = this.state;\n        const { images } = this.props;\n        return(\n            <div className=\"mael-image-gallery\" hidden={!isShow} >\n                <Icon type='close' onClick={ this.close } />\n                <Toucher className=\"image-gallery-swipe\" onSwipeRight={ this.slideLeft } onSwipeLeft={ this.slideRight } >\n                    <div className=\"image-gallery-arrow arrow-left\" onClick={ this.slideLeft } ><Icon type='bold-arrow-left' /></div>\n                    <div className=\"image-gallery-slides\">\n                        { this.getSlides() }\n                    </div>\n                    <div className=\"image-gallery-arrow arrow-right\" onClick={ this.slideRight } ><Icon type='bold-arrow-right' /></div>\n                </Toucher>\n                <p className='image-index tc'>{currentIndex + 1 }/{images.length}</p>\n            </div>\n        )\n    }\n}"]}]}