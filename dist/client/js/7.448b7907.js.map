{"version":3,"sources":["webpack:///./page/blog/Books/index.js"],"names":["props","books","allNum","page","allPage","banner","state","isLoading","bookLayoutDom","ReactDOM","findDOMNode","headerDom","refs","bookHeader","blogNavDom","document","getElementById","window","addEventListener","onscroll","length","getBooks","getBanners","removeEventListener","Axios","get","params","then","resData","res","data","setState","banners","background","text","href","author","map","book","id","img","title","desc","isReading","Component","defaultProps","e","event","_scrollTop","pageYOffset","documentElement","scrollTop","body","clientHeight","offsetHeight","_page","preState","concat"],"mappings":"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","file":"js/7.448b7907.js","sourcesContent":["import React, { Component } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Link } from 'react-router-dom';\nimport Axios from 'axios';\n\nexport default class Books extends Component {\n    constructor(props) {\n        super(props)\n        const {books, allNum, page, allPage, banner } = props;\n        this.state = {\n            books,\n            allNum,\n            page,\n            allPage,\n            banner,\n            isLoading: false,\n        }\n    }\n\n    static defaultProps = {\n        books: [],\n        page: 0,\n        allPage: 0,\n        banner: {\n            text: ['这个世界上的每样东西都生死未定，都充满了风险，那些不接受风险的人，那些不了解命运的人，在角落里日渐衰落。', '我忽然明白为什么我没能拥有尼诺，而莉拉能够拥有他。我不能追随那些真实的感情，我无法使自己打破陈规旧矩，我没有莉拉那么强烈的情感，她可以不顾一切去享受那一天一夜。'],\n            author: '新名字的故事'\n        }\n    }\n\n    componentDidMount() {\n        this.bookLayoutDom = ReactDOM.findDOMNode(this);\n        this.headerDom = ReactDOM.findDOMNode(this.refs.bookHeader);\n        this.blogNavDom = document.getElementById('IdNav');\n\n        window.addEventListener(\"scroll\", this.onscroll, false)\n        const {books} = this.state;\n\n        if (!books.length) {\n            this.getBooks(1);\n            this.getBanners();\n        }\n    }\n\n    onscroll = (e) => {\n        e = e || window.event;\n        let _scrollTop = window.pageYOffset\n                || (document.documentElement && document.documentElement.scrollTop)\n                || document.body.scrollTop\n                || 0;\n\n        const { page, allPage } = this.state;\n        if ( (_scrollTop + document.documentElement.clientHeight) > (this.bookLayoutDom.offsetHeight - 200) ) {\n            (page < allPage) && this.getBooks(page + 1);\n        }\n\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener(\"scroll\", this.onscroll);\n    }\n\n    getBooks = (_page) => {\n        if ( this.state.isLoading ) return;\n        this.setState({\n            isLoading: true\n        });\n        Axios.get('/api/get/books', {\n            params: {\n                page: _page,\n            }\n        })\n        .then(res => {\n            let resData = res.data;\n            this.setState(preState => {\n                let books = preState.books.concat(resData.books);\n                return {\n                    books,\n                    allNum: resData.allNum,\n                    page: resData.page,\n                    allPage: resData.allPage,\n                    isLoading: false\n                }\n            })\n        });\n    }\n\n    getBanners() {\n        Axios.get('/api/get/banners', {\n            params: {\n                page: 'BOOK'\n            }\n        })\n        .then( res => {\n            let resData = res.data;\n            this.setState({\n                banner: resData.banners[0]\n            })\n        })\n    }\n\n\n    render() {\n        const { books, isLoading, banner } = this.state;\n        return (\n            <div className=\"blog-books-layout clearfix \">\n                <div className=\"blog-books-header\" ref='bookHeader' >\n                    <img src=\"//cdn.liayal.com/image/books_banner.jpg\" alt=\"\"/>\n                    <div className=\"text-wrap\">\n                        <p><span style={{background: \"#B6BABD\"}} >{banner.text[0]}</span>{banner.text[1]}</p>\n                        <div className='tr author'><a href={ banner.href || \"javascript:void(0);\"} target=\"_blank\">—— 《{banner.author}》</a></div>\n                    </div>\n                </div>\n\n                <div className=\"middle-text tc \">\n                    <h2>杂而不精的读者</h2>\n                    <p>当我需要安静的时候，我想要一本书；当我安静的时候，我更想要一本书。不喜欢任何香水味，却惟独喜欢书香味。一本书，就是一个世界。躲进这个世界之中，就可以和当下的一切烦恼与琐碎隔离开来。</p>\n                </div>\n\n                <div className=\"books-list clearfix \">\n                    {books.length ? books.map( book =>\n                        <div className=\"blog-books-item\" key={book.id} >\n                        <div className=\"books-wrap clearfix\">\n                            <div className=\"cover\">\n                                <img src={book.img} alt=\"\"/>\n                            </div>\n                            <div className=\"info\">\n                                <h4 className=\"title\">{book.title}</h4>\n                                <p className=\"author\">{book.author}</p>\n                                <p className=\"intro\">{book.desc}</p>\n                                { book.href ? <div className=\"btn\">\n                                    <a href={ book.href } className=\"read-btn\">试读</a>\n                                </div> : null}\n                            </div>\n                            {book.isReading ? <span className='reading'>Reading</span> : null}\n                        </div>\n                    </div>\n                    ) : null}\n                </div>\n                { isLoading ? <p className=\"loading\">加载中...</p> : null}\n            </div>\n        )\n    }\n}"],"sourceRoot":""}