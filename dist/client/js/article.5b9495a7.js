(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{329:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=g(a(7)),n=g(a(17)),c=g(a(4)),s=g(a(6)),m=g(a(3)),o=g(a(5)),r=a(1),i=g(r),d=g(a(0)),u=g(a(33)),f=g(a(219)),p=g(a(107)),h=g(a(497)),y=g(a(8)),E=g(a(499));function g(e){return e&&e.__esModule?e:{default:e}}f.default.locale("zh-cn");var w=function(e){function t(e){(0,c.default)(this,t);var a=(0,m.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e)),l=e.article,s=e.commentsData;return a.state={article:l,commentsData:s},a}return(0,o.default)(t,e),(0,s.default)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.match.params,a=this.state.article;a&&a.id==t.id||(u.default.get("/api/get/article/"+t.id,{params:{filter:"web"}}).then(function(t){var a=t.data;document.title=a.article.title+"  - 「JI · 记小栈」",e.setState({article:a.article})}),u.default.get("/api/get/comments?articleid="+t.id).then(function(t){var a=t.data;e.setState({commentsData:a})}))}},{key:"componentDidMount",value:function(){var e=this.state.article;e&&(document.title=e.title+"  - 「JI · 记小栈」")}},{key:"commentDidUpdate",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.article,a=e.commentsData,n=this.props.match.params,c=t||{},s=(0,y.default)("blog-article-layout",(0,l.default)({},"blog-article-"+(c.category&&c.category.toLocaleLowerCase()),c.category));return i.default.createElement("div",{className:s},i.default.createElement("div",{className:"blog-article-layout-wrap"},i.default.createElement("h2",{className:"article-title"},i.default.createElement("p",null,i.default.createElement("em",null,c.title))),t?i.default.createElement("article",{className:"blog-article-body"},i.default.createElement("div",{className:"article-content",dangerouslySetInnerHTML:{__html:c.htmlContent}}),i.default.createElement("div",{className:"article-tips"},i.default.createElement("p",{className:"article-desc"},i.default.createElement("span",null,"写于 ",(0,f.default)(c.createTime).format("LL")),c.tags&&c.tags.length?i.default.createElement("span",{className:"ml"},i.default.createElement(p.default,{type:"cc-tag"})," ",c.tags.map(function(e){return e.name+" "})):null,i.default.createElement("span",{className:"ml"},i.default.createElement(p.default,{type:"visit"})," ",c.visited||0)),i.default.createElement("p",null,"如非特别注明，文章皆为原创。"),i.default.createElement("p",null,i.default.createElement("b",null,"转载请注明出处：")," ",i.default.createElement("a",{href:"https://www.liayal.com/article/"+c.id},"https://www.liayal.com/article/"+c.id)))):i.default.createElement(E.default,null),i.default.createElement("section",{className:"article-share-box"},i.default.createElement("a",{href:"https://service.weibo.com/share/share.php?url="+encodeURIComponent("https://www.liayal.com/article/"+c.id)+"&title="+encodeURIComponent(c.title)+"&pic="+encodeURIComponent(c.banner||"")+"&appkey=",className:"share-icon"},i.default.createElement(p.default,{type:"weibo"})),i.default.createElement("a",{href:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+encodeURIComponent("https://www.liayal.com/article/"+c.id)+"&title="+encodeURIComponent(c.title)+"&desc="+encodeURIComponent(c.abstract)+"&summary="+encodeURIComponent(c.abstract)+"&site="+encodeURIComponent("//hynal.com"),className:"share-icon"},i.default.createElement(p.default,{type:"qzone"})),i.default.createElement("a",{href:"http://shuo.douban.com/!service/share?href="+encodeURIComponent("https://www.liayal.com/article/"+c.id)+"&name="+encodeURIComponent(c.title)+"&text="+encodeURIComponent(c.abstract)+"&image="+encodeURIComponent(c.banner||"")+"&starid=0&aid=0&style=11",className:"share-icon"},i.default.createElement(p.default,{type:"douban"}))),i.default.createElement(h.default,{articleid:n.id,commentsData:a})))}}]),t}(r.Component);w.defaultProps={commentsData:{}},w.defaultPropTypes={commentsData:d.default.object},t.default=w},497:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=N(a(89)),n=N(a(2)),c=N(a(495)),s=N(a(17)),m=N(a(4)),o=N(a(6)),r=N(a(3)),i=N(a(5)),d=a(1),u=N(d),f=N(a(0)),p=N(a(219)),h=(N(a(8)),N(a(107))),y=N(a(159)),E=N(a(222)),g=N(a(33)),w=a(220),b=a(494);function N(e){return e&&e.__esModule?e:{default:e}}var v={height:20};p.default.locale("zh-cn");var k=function(e){function t(e){(0,m.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.preventDefault=function(e){e.preventDefault()},a.exportComment=function(e){var t=a.state.reply,l=/access\_token/g.test(document.cookie)?{name:"记小栈",email:"mael.liang@live.com",site:"https://www.liayal.com",avatar:"https://cdn.liayal.com/image/logo_min.png"}:window.localStorage.getItem("_liayal_user");l&&e?a.saveComment({user:"string"==typeof l?JSON.parse(l):l,reply:t?t.id:null,commentCont:e}):e&&a.setState({showUserInfo:!0,commentCont:e})},a.commentSubmit=function(){var e=a.refs.userName.value,t=a.refs.userEamil.value,l=a.refs.userSite.value,n=a.state,s=n.reply,m=n.commentCont;return t&&e?/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/g.test(t)?(window.localStorage.setItem("_liayal_user",(0,c.default)({name:e,email:t,site:l})),void a.saveComment({user:{name:e,email:t,site:l},reply:s?s.id:null,commentCont:m})):w.Toast.info("邮箱格式不正确呀！"):w.Toast.info("填一下昵称和邮箱呗！")},a.commentCancle=function(){a.setState({showUserInfo:!1})},a.showReplyModal=function(e){a.setState({isShowReplyModal:!0,reply:e})},a.closeReplyModal=function(){a.setState({isShowReplyModal:!1,reply:null})},a.getTimeString=function(e){var t=new Date,a=t.getDate(),l=new Date(e),n=l.getDate(),c=t.getTime()-e;return c<6e4?"刚刚":c<36e5?Math.ceil(c/6e4)+"分钟前":c<864e5&&a==n?"今天 "+(0,p.default)(e).format("HH:mm"):t.getYear()==l.getYear()?(0,p.default)(e).format("MM-DD HH:mm"):(0,p.default)(e).format("lll")},a.changePage=function(e,t){a.getComments(e)},a.state={showUserInfo:!1,isShowReplyModal:!1,reply:null,commentCont:null,commentsData:e.commentsData},a.caretIndex=0,a}return(0,i.default)(t,e),(0,o.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({commentsData:e.commentsData})}},{key:"componentDidMount",value:function(){}},{key:"saveComment",value:function(e){var t=this,a=this.props.articleid;g.default.post("/api/create/comment",(0,n.default)({},e,{articleid:a})).then(function(e){var a=e.data;200==a.code?(t.getComments(0),a.reply?t.refs.replyInput.clearTextarea():t.refs.commentInput.clearTextarea(),t.setState({showUserInfo:!1,isShowReplyModal:!1,reply:null,commentCont:null})):w.Toast.warn(a.message)}).catch(function(e){w.Toast.warn("发布失败")})}},{key:"getComments",value:function(e){var t=this;g.default.get("/api/get/comments",{params:{articleid:this.props.articleid,page:e,size:20}}).then(function(e){var a=e.data;t.setState({commentsData:a})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.showUserInfo,n=t.isShowReplyModal,c=t.reply,s=t.commentsData,m=s.comments,o=s.allPage,r=s.page,i=s.allNum;return u.default.createElement("article",{className:"blog-comment"},u.default.createElement(E.default,{exportComment:this.exportComment,ref:"commentInput"}),u.default.createElement("h3",{className:"blog-comment-title"},"评论"),u.default.createElement("div",{className:"comment-list"},m&&m.length?m.map(function(t,a){return u.default.createElement("div",{className:"comment-item clearfix border-b",key:a,name:t.id},u.default.createElement("div",{className:"comment-avatar fl"},t.user&&t.user.avatar?u.default.createElement("img",{src:t.user.avatar,alt:"",className:"avatar"}):u.default.createElement(h.default,{type:"avatar"})),u.default.createElement("div",{className:"comment-body fl"},u.default.createElement("h6",null,t.user.name,u.default.createElement("small",null,(0,b.getTimeString)(t.createTime))),t.reply?u.default.createElement(y.default,{style:v},u.default.createElement("blockquote",{className:"nowrapmulti"},"@",t.reply.user.name,": ",t.reply.commentCont)):null,u.default.createElement(y.default,{style:v},u.default.createElement("p",null,t.commentCont)),u.default.createElement("div",{className:"comment-reply"},u.default.createElement(h.default,{type:"reply",onClick:function(a){e.showReplyModal(t)}}))))}):u.default.createElement("p",{className:"no-comments tc"},"～ 评论还没有，沙发可以有 O(∩_∩)O~ ")),o>1?u.default.createElement(l.default,{size:"small",total:i,current:r,defaultPageSize:20,onChange:this.changePage}):null,u.default.createElement("div",{className:"comment-modal",hidden:!a,style:{zIndex:5},ref:"UserModal"},u.default.createElement("div",{className:"comment-user-modal-form"},u.default.createElement("img",{src:"//cdn.liayal.com/image/logo.png",alt:""}),u.default.createElement("input",{type:"text",name:"name",placeholder:"昵称(必填)",ref:"userName"}),u.default.createElement("input",{type:"text",autoComplete:"email",name:"email",placeholder:"xxxx@qq.com(必填)",ref:"userEamil"}),u.default.createElement("input",{type:"text",name:"site",placeholder:"www.yourblog.com",ref:"userSite"}),u.default.createElement("div",{className:"btns"},u.default.createElement("button",{onClick:this.commentCancle},"取消"),u.default.createElement("button",{onClick:this.commentSubmit},"确认")))),u.default.createElement("div",{className:"comment-modal",hidden:!n,ref:"ReplyModal"},u.default.createElement("div",{className:"comment-reply-from"},u.default.createElement("h6",{className:"tl"},"回复：",c&&c.user.name," ",u.default.createElement(h.default,{type:"close-x comment-close",onClick:this.closeReplyModal})),u.default.createElement(E.default,{exportComment:this.exportComment,ref:"replyInput"}))))}}]),t}(d.Component);k.defaultProps={articleid:"",commentsData:{}},k.defaultPropTypes={commentsData:f.default.object},t.default=k},499:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n=a(1),c=(l=n)&&l.__esModule?l:{default:l};t.default=function(e){return c.default.createElement("article",{className:"blog-article-body blog-article-body-loading"},c.default.createElement("h2",{className:"article-title article-loading-block",style:{width:"100%"}}),c.default.createElement("p",{className:"article-desc"},c.default.createElement("span",{className:"article-loading-block",style:{width:"28%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",{className:"article-loading-block",style:{width:"94%"}}),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"22%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"66%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"56%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"39%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"21%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"15%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"22%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"66%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"56%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"39%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"21%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"15%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"22%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"66%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"42%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"46%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"11%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"25%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"22%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"66%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"21%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"15%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"56%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"39%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"11%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"25%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"11%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"25%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})),c.default.createElement("p",null,c.default.createElement("span",{className:"article-loading-block",style:{width:"21%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"15%"}}),c.default.createElement("span",{className:"article-loading-block",style:{width:"40%"}})))}}}]);