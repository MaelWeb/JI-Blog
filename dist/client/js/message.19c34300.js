(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{221:function(e,t,a){e.exports=a(28)(112)},334:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=C(a(495)),s=C(a(89)),n=C(a(2)),m=C(a(17)),o=C(a(4)),r=C(a(6)),u=C(a(3)),c=C(a(5)),i=a(1),d=C(i),f=C(a(9)),g=C(a(0)),p=a(31),h=C(a(33)),v=(C(a(8)),C(a(222))),y=C(a(508)),E=(C(a(117)),a(220)),w=C(a(107)),b=a(494),N=C(a(159));function C(e){return e&&e.__esModule?e:{default:e}}var x={height:20},_=function(e){function t(e){(0,o.default)(this,t);var a=(0,u.default)(this,(t.__proto__||(0,m.default)(t)).call(this,e));S.call(a);var l=e.messageBanners,s=e.comments,n=e.allPage,r=e.page,c=e.allNum,i=e.newComments;return a.state={messageBanners:l,comments:s,newComments:i,allNum:c,allPage:n,page:r,showUserInfo:!1,isShowReplyModal:!1,reply:null,commentCont:null},a}return(0,c.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){var e=this;this.headerDom=f.default.findDOMNode(this.refs.mressageHeader),this.messageLayoutDom=f.default.findDOMNode(this),this.blogNavDom=document.getElementById("IdNav"),this.blogNavDom.classList.add("blog-message-header"),window.addEventListener("scroll",this.onscroll,!1),this.state.comments.length||(h.default.get("/api/one").then(function(t){e.setState({messageBanners:t.data.data})}),this.getComments(1)),h.default.get("/api/get/comments",{params:{page:1,size:15}}).then(function(t){var a=t.data;e.setState({newComments:a.comments})})}},{key:"componentWillUnmount",value:function(){this.blogNavDom.classList.remove("blog-message-header"),window.removeEventListener("scroll",this.onscroll)}},{key:"getComments",value:function(e){var t=this;h.default.get("/api/get/comments",{params:{articleid:"message666",page:e,size:10}}).then(function(e){var a=e.data;t.setState({comments:a.comments,page:a.page,allPage:a.allPage,allNum:a.allNum})})}},{key:"saveComment",value:function(e){var t=this,a=this.state.comments;h.default.post("/api/create/comment",(0,n.default)({},e,{articleid:"message666"})).then(function(l){var s=l.data;200==s.code?(a.unshift(s.comment),e.reply?t.refs.replyInput.clearTextarea():t.refs.commentInput.clearTextarea(),t.setState({showUserInfo:!1,isShowReplyModal:!1,reply:null,comments:a,commentCont:null})):E.Toast.warn(s.message)}).catch(function(e){E.Toast.warn("发布失败")})}},{key:"getDateDom",value:function(){var e=(new Date).toDateString().split(" ");return d.default.createElement("div",{className:"blog-message-widget-date"},d.default.createElement("strong",null,e[2]),d.default.createElement("small",null,e[1]," ",e[3]))}},{key:"render",value:function(){var e=this,t=this.state,a=t.messageBanners,l=t.comments,n=t.showUserInfo,m=t.isShowReplyModal,o=t.reply,r=t.allPage,u=t.allNum,c=t.page,i=t.newComments,f=a[Math.floor(Math.random()*(a.length-1))+1]||{};return d.default.createElement("div",{className:"blog-message-layout "},d.default.createElement("div",{className:"blog-message-header header-banner",style:{backgroundImage:"url(//cdn.liayal.com/banner/pexels-photo-1096848.jpeg)"},ref:"mressageHeader"},d.default.createElement("div",{className:"blog-message-header-input"},d.default.createElement(v.default,{exportComment:this.exportComment,placeholder:f.text,ref:"commentInput"}))),d.default.createElement("div",{className:"blog-message-body clearfix"},d.default.createElement("div",{className:"blog-message-list-wrap fl"},d.default.createElement("div",{className:"blog-message-list"},d.default.createElement(w.default,{className:"blog-message-icon",type:"message"}),l.length?l.map(function(t,a){return!t.isRemove&&d.default.createElement(y.default,{key:a,comment:t,replyComent:e.showReplyModal,isFloatRight:!(a%2==0)})}):null,r>1?d.default.createElement(s.default,{size:"small",total:u,current:c,defaultPageSize:10,onChange:this.changePage}):null)),d.default.createElement("div",{className:"blog-message-other fr"},d.default.createElement("div",{className:"blog-message-widget-box"},d.default.createElement("div",{className:"blog-message-widget-one"},d.default.createElement("img",{src:a[0]?a[0].imgUrl:"http://image.wufazhuce.com/Fu1qjJjsQ_wZ_3BR-utNJwUIGY-P",alt:""}),d.default.createElement("div",{className:"blog-message-widget-footer"},d.default.createElement("p",{className:"blog-message-widget-txt"},a[0]?a[0].text:"懂的人会懂，感动的人会感动，无关的人，敬请错过。"),this.getDateDom()))),d.default.createElement("div",{className:"blog-message-widget-up"},d.default.createElement("h5",null,"最近评论"),d.default.createElement("ul",{className:"blog-message-widge-list"},i.length?i.map(function(e){return d.default.createElement("li",null,d.default.createElement(p.Link,{to:"message666"!=e.articleid?"/article/"+e.articleid:"#"+e.id},d.default.createElement("h6",null,e.user.name,d.default.createElement("small",null,(0,b.getTimeString)(e.createTime))),d.default.createElement(N.default,{style:x},d.default.createElement("p",null,e.commentCont))))}):null)))),d.default.createElement("div",{className:"comment-modal",hidden:!n,style:{zIndex:5},ref:"UserModal"},d.default.createElement("div",{className:"comment-user-modal-form"},d.default.createElement("img",{src:"//cdn.liayal.com/image/logo.png",alt:""}),d.default.createElement("input",{type:"text",name:"name",placeholder:"昵称(必填)",ref:"userName"}),d.default.createElement("input",{type:"text",autoComplete:"email",name:"email",placeholder:"xxxx@qq.com(必填)",ref:"userEamil"}),d.default.createElement("input",{type:"text",name:"site",placeholder:"www.yourblog.com",ref:"userSite"}),d.default.createElement("div",{className:"btns"},d.default.createElement("button",{onClick:this.commentCancle},"取消"),d.default.createElement("button",{onClick:this.commentSubmit},"确认")))),d.default.createElement("div",{className:"comment-modal",hidden:!m,ref:"ReplyModal"},d.default.createElement("div",{className:"comment-reply-from"},d.default.createElement("h6",{className:"tl"},"回复：",o&&o.user.name," ",d.default.createElement(w.default,{type:"close-x comment-close",onClick:this.closeReplyModal})),d.default.createElement(v.default,{exportComment:this.exportComment,ref:"replyInput"}))))}}]),t}(i.Component);_.defaultProps={comments:[],messageBanners:[],newComments:[],allNum:0,allPage:0,page:0},_.defaultPropTypes={comments:g.default.array,messageBanners:g.default.array,newComments:g.default.array};var S=function(){var e=this;this.onscroll=function(t){t=t||window.event,(window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop||0)>=e.headerDom.offsetHeight-e.blogNavDom.offsetHeight?e.blogNavDom.classList.remove("blog-message-header"):e.blogNavDom.classList.add("blog-message-header")},this.changePage=function(t,a){e.getComments(t)},this.exportComment=function(t){var a=e.state.reply,l=/access\_token/g.test(document.cookie)?{name:"记小栈",email:"mael.liang@live.com",site:"https://www.liayal.com",avatar:"https://cdn.liayal.com/image/logo_min.png"}:window.localStorage.getItem("_liayal_user");if(!t)return E.Toast.info("你倒是写点什么啊！");l&&t?e.saveComment({user:"string"==typeof l?JSON.parse(l):l,reply:a?a.id:null,commentCont:t}):t&&e.setState({showUserInfo:!0,commentCont:t})},this.commentSubmit=function(){var t=e.refs.userName.value,a=e.refs.userEamil.value,s=e.refs.userSite.value,n=e.state,m=n.reply,o=n.commentCont;return a&&t?/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/g.test(a)?(window.localStorage.setItem("_liayal_user",(0,l.default)({name:t,email:a,site:s})),void e.saveComment({user:{name:t,email:a,site:s},reply:m?m.id:null,commentCont:o})):E.Toast.info("邮箱格式不正确呀！"):E.Toast.info("填一下昵称和邮箱呗！")},this.commentCancle=function(){e.setState({showUserInfo:!1})},this.showReplyModal=function(t){e.setState({isShowReplyModal:!0,reply:t})},this.closeReplyModal=function(){e.setState({isShowReplyModal:!1})}};t.default=_},508:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=h(a(7)),s=h(a(17)),n=h(a(4)),m=h(a(6)),o=h(a(3)),r=h(a(5)),u=a(1),c=h(u),i=h(a(0)),d=h(a(107)),f=h(a(159)),g=h(a(8)),p=a(494);function h(e){return e&&e.__esModule?e:{default:e}}var v={height:20},y=function(e){function t(e){(0,n.default)(this,t);var a=(0,o.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e));return a.replyComent=function(){var e=a.props.comment;a.props.replyComent(e)},a.state={},a}return(0,r.default)(t,e),(0,m.default)(t,[{key:"randomClassName",value:function(){return["blog-message-item-default","blog-message-item-ffcdac","blog-message-item-fcd474"][parseInt(3*Math.random())]}},{key:"render",value:function(){var e,t=this.props,a=t.className,s=t.comment,n=t.isFloatRight,m=this.randomClassName();return c.default.createElement("div",{className:(0,g.default)("blog-message-item",(e={},(0,l.default)(e,a,a),(0,l.default)(e,m,m),e))},c.default.createElement("div",{className:"blog-message-item-box clearfix"},c.default.createElement("div",{className:(0,g.default)("blog-message-item-box-avatar",{fl:!n,fr:n})},s.user&&s.user.avatar?c.default.createElement("div",{className:"avatar-img"},c.default.createElement("img",{src:s.user.avatar,alt:""})):c.default.createElement(d.default,{type:"avatar"})),c.default.createElement("div",{className:(0,g.default)("blog-message-item-body",{fl:!n,fr:n})},c.default.createElement("p",{className:"blog-message-item-user"},s.user.name,c.default.createElement("small",null,(0,p.getTimeString)(s.createTime))),c.default.createElement("div",{className:"blog-message-item-text",onClick:this.replyComent},s.reply?c.default.createElement(f.default,{style:v},c.default.createElement("blockquote",{className:"nowrapmulti"},"@",s.reply.user.name,": ",s.reply.commentCont)):null,c.default.createElement(f.default,{style:v},c.default.createElement("p",null,s.commentCont))))))}}]),t}(u.Component);y.defaultProps={className:"",comment:{},isFloatRight:!1,replyComent:function(){}},y.propTypes={className:i.default.string,comment:i.default.object,isFloatRight:i.default.bool,replyComent:i.default.func},t.default=y}}]);